(()=>{var e={};e.id=698,e.ids=[698],e.modules={1132:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/user/studio/src/app/admin/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/user/studio/src/app/admin/page.tsx","default")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},6211:(e,t,r)=>{"use strict";r.d(t,{A0:()=>l,BF:()=>o,Hj:()=>d,XI:()=>i,nA:()=>u,nd:()=>c});var s=r(60687),a=r(43210),n=r(4780);let i=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{className:"relative w-full overflow-auto",children:(0,s.jsx)("table",{ref:r,className:(0,n.cn)("w-full caption-bottom text-sm",e),...t})}));i.displayName="Table";let l=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)("thead",{ref:r,className:(0,n.cn)("[&_tr]:border-b",e),...t}));l.displayName="TableHeader";let o=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)("tbody",{ref:r,className:(0,n.cn)("[&_tr:last-child]:border-0",e),...t}));o.displayName="TableBody",a.forwardRef(({className:e,...t},r)=>(0,s.jsx)("tfoot",{ref:r,className:(0,n.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t})).displayName="TableFooter";let d=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)("tr",{ref:r,className:(0,n.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));d.displayName="TableRow";let c=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)("th",{ref:r,className:(0,n.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));c.displayName="TableHead";let u=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)("td",{ref:r,className:(0,n.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));u.displayName="TableCell",a.forwardRef(({className:e,...t},r)=>(0,s.jsx)("caption",{ref:r,className:(0,n.cn)("mt-4 text-sm text-muted-foreground",e),...t})).displayName="TableCaption"},6475:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{callServer:function(){return s.callServer},createServerReference:function(){return n},findSourceMapURL:function(){return a.findSourceMapURL}});let s=r(11264),a=r(11448),n=r(19357).createServerReference},7085:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{KO:()=>f,Mc:()=>c,Md:()=>x,RV:()=>m,SO:()=>h,X2:()=>u});var a=r(91199);r(42087);var n=r(31371),i=r(7879),l=r(33331),o=e([n,i]);function d(e){if(null==e)return e;if("function"==typeof e.toDate)return e.toDate().toISOString();if(Array.isArray(e))return e.map(d);if("object"==typeof e){let t={};for(let r in e)t[r]=d(e[r]);return t}return e}async function c(){try{let e=i.Timestamp.fromMillis(Date.now()-6048e5),[t,r,s,a,l]=await Promise.all([n.G7.collection("users").get(),n.G7.collection("openHouses").get(),n.G7.collection("feedbackForms").where("type","==","global").get(),n.G7.collection("settings").doc("appDefaults").get(),n.G7.collection("gifts").get()]),o=t.docs.map(e=>({id:e.id,...e.data()})),c=o.filter(t=>t.createdAt&&t.createdAt>=e).length,u=r.docs.map(e=>({id:e.id,...e.data()})),h=u.filter(t=>t.createdAt&&t.createdAt>=e).length,f=l.docs.map(e=>({id:e.id,...e.data()})),m=f.filter(t=>t.createdAt&&t.createdAt>=e).length,x=s.docs.map(e=>({id:e.id,...e.data()})),p=a.exists?a.data():{};return{stats:{totalUsers:o.length,newUsers7Days:c,totalOpenHouses:u.length,newOpenHouses7Days:h,totalGifts:f.length,newGifts7Days:m},users:d(o),openHouses:d(u),forms:d(x),settings:d(p)}}catch(e){if("NOT_FOUND"===e.code||e.details&&e.details.includes("NOT_FOUND"))return console.log("A required collection was not found, returning default empty/zero values."),{stats:{totalUsers:0,newUsers7Days:0,totalOpenHouses:0,newOpenHouses7Days:0,totalGifts:0,newGifts7Days:0},users:[],openHouses:[],forms:[],settings:{}};throw console.error("Error in getAdminDashboardData:",e),Error("Failed to fetch admin dashboard data: "+e.message)}}[n,i]=o.then?(await o)():o;let p=process.env.GIFTBIT_API_KEY,g="https://api-testbed.giftbit.com/papi/v1",b={ca:"CAD",us:"USD",au:"AUD",global:"USD"};async function u(){if(!p)throw Error("GIFTBIT_API_KEY is not configured on the server.");try{let[e,t]=await Promise.all([fetch(`${g}/regions`,{headers:{Authorization:`Bearer ${p}`},next:{revalidate:86400}}),fetch(`${g}/brands?limit=500`,{headers:{Authorization:`Bearer ${p}`},next:{revalidate:3600}})]);if(!e.ok||!t.ok)throw console.error("Giftbit API Error:",{regionsStatus:e.status,brandsStatus:t.status}),Error("Failed to fetch data from Giftbit.");let r=await e.json(),s=await t.json(),a=(r.regions||[]).map(e=>{var t;let r=(t=e.name,"USA"===t?"us":"Canada"===t?"ca":"Australia"===t?"au":t.toLowerCase());return{...e,code:r,currency:b[r]||"USD"}}),n=(s.brands||[]).map(e=>{let t=[];return e.brand_code.endsWith("CA")&&t.push("ca"),e.brand_code.endsWith("US")&&t.push("us"),e.brand_code.endsWith("AU")&&t.push("au"),0===t.length&&t.push("us","ca","au","global"),{...e,region_codes:e.region_codes||t}});return{regions:a,brands:n}}catch(e){throw console.error("Error fetching from Giftbit:",e.message),Error("Could not retrieve Giftbit data.")}}async function h(e){try{let t=n.G7.collection("settings").doc("appDefaults");return await t.set({giftbit:e},{merge:!0}),{success:!0}}catch(e){return console.error("Error saving Giftbit settings:",e),{success:!1,message:"Failed to save settings."}}}async function f(){p||console.log("GIFTBIT_API_KEY is not configured on the server. Skipping Giftbit API call.");try{let[e,t,r]=await Promise.all([n.G7.collection("gifts").orderBy("createdAt","desc").get(),n.G7.collection("users").get(),p?fetch(`${g}/gifts?limit=500`,{headers:{Authorization:`Bearer ${p}`},next:{revalidate:60}}):Promise.resolve(null)]),s=new Map(t.docs.map(e=>[e.id,e.data()])),a=e.docs.map(e=>({id:e.id,...e.data()})),i=new Map;r&&r.ok?((await r.json()).gifts||[]).forEach(e=>{i.set(e.uuid,e)}):r&&console.error("Giftbit API Error:",{status:r.status,body:await r.text()});let l=a.map(e=>{let t=s.get(e.userId),r=i.get(e.id);return{...e,senderName:t?.name||"Unknown User",senderEmail:t?.email||"N/A",giftbitStatus:r?.status,giftbitRedeemedDate:r?.redeemed_date}});return d(l)}catch(e){throw console.error("Error in getAdminGiftData:",e),Error("Failed to fetch admin gift data: "+e.message)}}async function m(e){if(!p)return{success:!1,message:"GIFTBIT_API_KEY is not configured on the server."};try{let t=await fetch(`${g}/gifts/${e}`,{method:"DELETE",headers:{Authorization:`Bearer ${p}`}});if(t.ok){let t=n.G7.collection("gifts").doc(e);return await t.update({status:"Cancelled"}),{success:!0,message:"Gift successfully cancelled."}}{let e=await t.json(),r=e.errors?.[0]?.message||"Failed to cancel gift.";return console.error("Giftbit Cancel API Error:",e),{success:!1,message:r}}}catch(e){return console.error("Error cancelling Giftbit reward:",e),{success:!1,message:"An unexpected error occurred."}}}async function x(){if(!p)return console.log("GIFTBIT_API_KEY is not configured on the server."),null;try{let e=await fetch(`${g}/funds`,{headers:{Authorization:`Bearer ${p}`},next:{revalidate:300}});if(!e.ok)throw console.error("Giftbit Funds API Error:",{status:e.status,body:await e.text()}),Error("Failed to fetch balance from Giftbit.");return(await e.json()).balance_in_cents}catch(e){return console.error("Error fetching Giftbit balance:",e.message),null}}(0,l.D)([c,u,h,f,m,x]),(0,a.A)(c,"00fcf9e9e6af0f45e38921aaa0add6f733eb9b9555",null),(0,a.A)(u,"0060f2626fae36a5d8bd07ebfd3f4740f8f087f2cd",null),(0,a.A)(h,"407bb6f56c7e5a4a370639c232be633c1d88a6eb1f",null),(0,a.A)(f,"006a0aecd529551c1ed2d9b93f7e44949be03e83f1",null),(0,a.A)(m,"40089f17ceaf65bc4808670c49344e3908c1f60283",null),(0,a.A)(x,"006240ef5553d2ad3789ed54966942dcb024bb4a28",null),s()}catch(e){s(e)}})},7879:e=>{"use strict";e.exports=import("firebase-admin/firestore")},9801:e=>{"use strict";e.exports=import("firebase-admin/app")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11516:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(82614).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},14276:e=>{"use strict";e.exports=import("firebase-admin/auth")},16301:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.r(t),r.d(t,{"0060f2626fae36a5d8bd07ebfd3f4740f8f087f2cd":()=>a.X2,"006240ef5553d2ad3789ed54966942dcb024bb4a28":()=>a.Md,"006a0aecd529551c1ed2d9b93f7e44949be03e83f1":()=>a.KO,"00fcf9e9e6af0f45e38921aaa0add6f733eb9b9555":()=>a.Mc,"40089f17ceaf65bc4808670c49344e3908c1f60283":()=>a.RV,"407bb6f56c7e5a4a370639c232be633c1d88a6eb1f":()=>a.SO});var a=r(7085),n=e([a]);a=(n.then?(await n)():n)[0],s()}catch(e){s(e)}})},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19771:e=>{"use strict";e.exports=require("process")},21820:e=>{"use strict";e.exports=require("os")},22820:(e,t,r)=>{Promise.resolve().then(r.bind(r,61193))},24026:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(82614).A)("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]])},24803:e=>{"use strict";e.exports=import("firebase-admin/storage")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},31371:(e,t,r)=>{"use strict";r.a(e,async(e,s)=>{try{r.d(t,{G7:()=>c});var a=r(9801),n=r(7879),i=r(14276),l=r(24803),o=e([a,n,i,l]);[a,n,i,l]=o.then?(await o)():o;let d=(0,a.getApps)().length?(0,a.getApp)():(0,a.initializeApp)(),c=(0,n.getFirestore)(d);(0,i.getAuth)(d),(0,l.getStorage)(d),s()}catch(e){s(e)}})},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},34729:(e,t,r)=>{"use strict";r.d(t,{T:()=>i});var s=r(60687),a=r(43210),n=r(4780);let i=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)("textarea",{className:(0,n.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...t}));i.displayName="Textarea"},35137:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(82614).A)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},35265:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(82614).A)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]])},37366:e=>{"use strict";e.exports=require("dns")},44412:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>tS});var s=r(60687),a=r(43210),n=r(75535),i=r(50944),l=r(44493),o=r(6211),d=r(70569),c=r(11273),u=r(72942),h=r(46059),f=r(3416),m=r(43),x=r(65551),p=r(96963),g="Tabs",[b,j]=(0,c.A)(g,[u.RG]),v=(0,u.RG)(),[w,y]=b(g),N=a.forwardRef((e,t)=>{let{__scopeTabs:r,value:a,onValueChange:n,defaultValue:i,orientation:l="horizontal",dir:o,activationMode:d="automatic",...c}=e,u=(0,m.jH)(o),[h,g]=(0,x.i)({prop:a,onChange:n,defaultProp:i});return(0,s.jsx)(w,{scope:r,baseId:(0,p.B)(),value:h,onValueChange:g,orientation:l,dir:u,activationMode:d,children:(0,s.jsx)(f.sG.div,{dir:u,"data-orientation":l,...c,ref:t})})});N.displayName=g;var A="TabsList",S=a.forwardRef((e,t)=>{let{__scopeTabs:r,loop:a=!0,...n}=e,i=y(A,r),l=v(r);return(0,s.jsx)(u.bL,{asChild:!0,...l,orientation:i.orientation,dir:i.dir,loop:a,children:(0,s.jsx)(f.sG.div,{role:"tablist","aria-orientation":i.orientation,...n,ref:t})})});S.displayName=A;var C="TabsTrigger",k=a.forwardRef((e,t)=>{let{__scopeTabs:r,value:a,disabled:n=!1,...i}=e,l=y(C,r),o=v(r),c=D(l.baseId,a),h=T(l.baseId,a),m=a===l.value;return(0,s.jsx)(u.q7,{asChild:!0,...o,focusable:!n,active:m,children:(0,s.jsx)(f.sG.button,{type:"button",role:"tab","aria-selected":m,"aria-controls":h,"data-state":m?"active":"inactive","data-disabled":n?"":void 0,disabled:n,id:c,...i,ref:t,onMouseDown:(0,d.m)(e.onMouseDown,e=>{n||0!==e.button||!1!==e.ctrlKey?e.preventDefault():l.onValueChange(a)}),onKeyDown:(0,d.m)(e.onKeyDown,e=>{[" ","Enter"].includes(e.key)&&l.onValueChange(a)}),onFocus:(0,d.m)(e.onFocus,()=>{let e="manual"!==l.activationMode;m||n||!e||l.onValueChange(a)})})})});k.displayName=C;var E="TabsContent",R=a.forwardRef((e,t)=>{let{__scopeTabs:r,value:n,forceMount:i,children:l,...o}=e,d=y(E,r),c=D(d.baseId,n),u=T(d.baseId,n),m=n===d.value,x=a.useRef(m);return a.useEffect(()=>{let e=requestAnimationFrame(()=>x.current=!1);return()=>cancelAnimationFrame(e)},[]),(0,s.jsx)(h.C,{present:i||m,children:({present:r})=>(0,s.jsx)(f.sG.div,{"data-state":m?"active":"inactive","data-orientation":d.orientation,role:"tabpanel","aria-labelledby":c,hidden:!r,id:u,tabIndex:0,...o,ref:t,style:{...e.style,animationDuration:x.current?"0s":void 0},children:r&&l})})});function D(e,t){return`${e}-trigger-${t}`}function T(e,t){return`${e}-content-${t}`}R.displayName=E;var L=r(4780);let M=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)(S,{ref:r,className:(0,L.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));M.displayName=S.displayName;let G=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)(k,{ref:r,className:(0,L.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));G.displayName=k.displayName;let P=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)(R,{ref:r,className:(0,L.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));P.displayName=R.displayName;var _=r(32584),I=r(29867),F=r(89667),U=r(30474),H=r(85814),B=r.n(H),q=r(96834),z=r(48206),O=r(24026),$=r(24482),Y=r(82614);let X=(0,Y.A)("Wallet",[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]]);var V=r(58595);let W=(0,Y.A)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),Z=(0,Y.A)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),K=(0,Y.A)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);var Q=r(11516),J=r(69795),ee=r(92477);let et=(0,Y.A)("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);var er=r(35265),es=r(35137),ea=r(57207),en=r(90357),ei=r(65456),el=r(29523),eo=r(63503),ed=r(27605),ec=r(63442),eu=r(45880),eh=r(71669),ef=r(34729),em=r(15079),ex=r(74112),ep=r(35950),eg=r(21342),eb=r(13972),ej=r(6475);let ev=(0,ej.createServerReference)("00fcf9e9e6af0f45e38921aaa0add6f733eb9b9555",ej.callServer,void 0,ej.findSourceMapURL,"getAdminDashboardData"),ew=(0,ej.createServerReference)("0060f2626fae36a5d8bd07ebfd3f4740f8f087f2cd",ej.callServer,void 0,ej.findSourceMapURL,"getAvailableGiftbitRegionsAndBrands"),ey=(0,ej.createServerReference)("006a0aecd529551c1ed2d9b93f7e44949be03e83f1",ej.callServer,void 0,ej.findSourceMapURL,"getAdminGiftData"),eN=(0,ej.createServerReference)("006240ef5553d2ad3789ed54966942dcb024bb4a28",ej.callServer,void 0,ej.findSourceMapURL,"getGiftbitBalance"),eA=(0,ej.createServerReference)("407bb6f56c7e5a4a370639c232be633c1d88a6eb1f",ej.callServer,void 0,ej.findSourceMapURL,"saveGiftbitSettings"),eS=(0,ej.createServerReference)("40089f17ceaf65bc4808670c49344e3908c1f60283",ej.callServer,void 0,ej.findSourceMapURL,"cancelGiftbitReward");var eC=r(74627),ek=r(35780),eE=r(47138);function eR(e,t){let r=(0,eE.a)(e),s=(0,eE.a)(t),a=r.getTime()-s.getTime();return a<0?-1:a>0?1:a}var eD=r(11392),eT=r(3211),eL=r(9903),eM=r(79943),eG=r(98599),eP=r(83721),e_=r(18853),eI="Switch",[eF,eU]=(0,c.A)(eI),[eH,eB]=eF(eI),eq=a.forwardRef((e,t)=>{let{__scopeSwitch:r,name:n,checked:i,defaultChecked:l,required:o,disabled:c,value:u="on",onCheckedChange:h,form:m,...p}=e,[g,b]=a.useState(null),j=(0,eG.s)(t,e=>b(e)),v=a.useRef(!1),w=!g||m||!!g.closest("form"),[y=!1,N]=(0,x.i)({prop:i,defaultProp:l,onChange:h});return(0,s.jsxs)(eH,{scope:r,checked:y,disabled:c,children:[(0,s.jsx)(f.sG.button,{type:"button",role:"switch","aria-checked":y,"aria-required":o,"data-state":eY(y),"data-disabled":c?"":void 0,disabled:c,value:u,...p,ref:j,onClick:(0,d.m)(e.onClick,e=>{N(e=>!e),w&&(v.current=e.isPropagationStopped(),v.current||e.stopPropagation())})}),w&&(0,s.jsx)(e$,{control:g,bubbles:!v.current,name:n,value:u,checked:y,required:o,disabled:c,form:m,style:{transform:"translateX(-100%)"}})]})});eq.displayName=eI;var ez="SwitchThumb",eO=a.forwardRef((e,t)=>{let{__scopeSwitch:r,...a}=e,n=eB(ez,r);return(0,s.jsx)(f.sG.span,{"data-state":eY(n.checked),"data-disabled":n.disabled?"":void 0,...a,ref:t})});eO.displayName=ez;var e$=e=>{let{control:t,checked:r,bubbles:n=!0,...i}=e,l=a.useRef(null),o=(0,eP.Z)(r),d=(0,e_.X)(t);return a.useEffect(()=>{let e=l.current,t=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(o!==r&&t){let s=new Event("click",{bubbles:n});t.call(e,r),e.dispatchEvent(s)}},[o,r,n]),(0,s.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...i,tabIndex:-1,ref:l,style:{...e.style,...d,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function eY(e){return e?"checked":"unchecked"}let eX=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)(eq,{className:(0,L.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...t,ref:r,children:(0,s.jsx)(eO,{className:(0,L.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));eX.displayName=eq.displayName;var eV=r(13495),eW=r(66156),eZ=r(67969),eK="ScrollArea",[eQ,eJ]=(0,c.A)(eK),[e0,e1]=eQ(eK),e2=a.forwardRef((e,t)=>{let{__scopeScrollArea:r,type:n="hover",dir:i,scrollHideDelay:l=600,...o}=e,[d,c]=a.useState(null),[u,h]=a.useState(null),[x,p]=a.useState(null),[g,b]=a.useState(null),[j,v]=a.useState(null),[w,y]=a.useState(0),[N,A]=a.useState(0),[S,C]=a.useState(!1),[k,E]=a.useState(!1),R=(0,eG.s)(t,e=>c(e)),D=(0,m.jH)(i);return(0,s.jsx)(e0,{scope:r,type:n,dir:D,scrollHideDelay:l,scrollArea:d,viewport:u,onViewportChange:h,content:x,onContentChange:p,scrollbarX:g,onScrollbarXChange:b,scrollbarXEnabled:S,onScrollbarXEnabledChange:C,scrollbarY:j,onScrollbarYChange:v,scrollbarYEnabled:k,onScrollbarYEnabledChange:E,onCornerWidthChange:y,onCornerHeightChange:A,children:(0,s.jsx)(f.sG.div,{dir:D,...o,ref:R,style:{position:"relative","--radix-scroll-area-corner-width":w+"px","--radix-scroll-area-corner-height":N+"px",...e.style}})})});e2.displayName=eK;var e4="ScrollAreaViewport",e5=a.forwardRef((e,t)=>{let{__scopeScrollArea:r,children:n,nonce:i,...l}=e,o=e1(e4,r),d=a.useRef(null),c=(0,eG.s)(t,d,o.onViewportChange);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:i}),(0,s.jsx)(f.sG.div,{"data-radix-scroll-area-viewport":"",...l,ref:c,style:{overflowX:o.scrollbarXEnabled?"scroll":"hidden",overflowY:o.scrollbarYEnabled?"scroll":"hidden",...e.style},children:(0,s.jsx)("div",{ref:o.onContentChange,style:{minWidth:"100%",display:"table"},children:n})})]})});e5.displayName=e4;var e6="ScrollAreaScrollbar",e3=a.forwardRef((e,t)=>{let{forceMount:r,...n}=e,i=e1(e6,e.__scopeScrollArea),{onScrollbarXEnabledChange:l,onScrollbarYEnabledChange:o}=i,d="horizontal"===e.orientation;return a.useEffect(()=>(d?l(!0):o(!0),()=>{d?l(!1):o(!1)}),[d,l,o]),"hover"===i.type?(0,s.jsx)(e9,{...n,ref:t,forceMount:r}):"scroll"===i.type?(0,s.jsx)(e7,{...n,ref:t,forceMount:r}):"auto"===i.type?(0,s.jsx)(e8,{...n,ref:t,forceMount:r}):"always"===i.type?(0,s.jsx)(te,{...n,ref:t}):null});e3.displayName=e6;var e9=a.forwardRef((e,t)=>{let{forceMount:r,...n}=e,i=e1(e6,e.__scopeScrollArea),[l,o]=a.useState(!1);return a.useEffect(()=>{let e=i.scrollArea,t=0;if(e){let r=()=>{window.clearTimeout(t),o(!0)},s=()=>{t=window.setTimeout(()=>o(!1),i.scrollHideDelay)};return e.addEventListener("pointerenter",r),e.addEventListener("pointerleave",s),()=>{window.clearTimeout(t),e.removeEventListener("pointerenter",r),e.removeEventListener("pointerleave",s)}}},[i.scrollArea,i.scrollHideDelay]),(0,s.jsx)(h.C,{present:r||l,children:(0,s.jsx)(e8,{"data-state":l?"visible":"hidden",...n,ref:t})})}),e7=a.forwardRef((e,t)=>{var r,n;let{forceMount:i,...l}=e,o=e1(e6,e.__scopeScrollArea),c="horizontal"===e.orientation,u=tb(()=>m("SCROLL_END"),100),[f,m]=(r="hidden",n={hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}},a.useReducer((e,t)=>n[e][t]??e,r));return a.useEffect(()=>{if("idle"===f){let e=window.setTimeout(()=>m("HIDE"),o.scrollHideDelay);return()=>window.clearTimeout(e)}},[f,o.scrollHideDelay,m]),a.useEffect(()=>{let e=o.viewport,t=c?"scrollLeft":"scrollTop";if(e){let r=e[t],s=()=>{let s=e[t];r!==s&&(m("SCROLL"),u()),r=s};return e.addEventListener("scroll",s),()=>e.removeEventListener("scroll",s)}},[o.viewport,c,m,u]),(0,s.jsx)(h.C,{present:i||"hidden"!==f,children:(0,s.jsx)(te,{"data-state":"hidden"===f?"hidden":"visible",...l,ref:t,onPointerEnter:(0,d.m)(e.onPointerEnter,()=>m("POINTER_ENTER")),onPointerLeave:(0,d.m)(e.onPointerLeave,()=>m("POINTER_LEAVE"))})})}),e8=a.forwardRef((e,t)=>{let r=e1(e6,e.__scopeScrollArea),{forceMount:n,...i}=e,[l,o]=a.useState(!1),d="horizontal"===e.orientation,c=tb(()=>{if(r.viewport){let e=r.viewport.offsetWidth<r.viewport.scrollWidth,t=r.viewport.offsetHeight<r.viewport.scrollHeight;o(d?e:t)}},10);return tj(r.viewport,c),tj(r.content,c),(0,s.jsx)(h.C,{present:n||l,children:(0,s.jsx)(te,{"data-state":l?"visible":"hidden",...i,ref:t})})}),te=a.forwardRef((e,t)=>{let{orientation:r="vertical",...n}=e,i=e1(e6,e.__scopeScrollArea),l=a.useRef(null),o=a.useRef(0),[d,c]=a.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),u=tf(d.viewport,d.content),h={...n,sizes:d,onSizesChange:c,hasThumb:!!(u>0&&u<1),onThumbChange:e=>l.current=e,onThumbPointerUp:()=>o.current=0,onThumbPointerDown:e=>o.current=e};function f(e,t){return function(e,t,r,s="ltr"){let a=tm(r),n=t||a/2,i=r.scrollbar.paddingStart+n,l=r.scrollbar.size-r.scrollbar.paddingEnd-(a-n),o=r.content-r.viewport;return tp([i,l],"ltr"===s?[0,o]:[-1*o,0])(e)}(e,o.current,d,t)}return"horizontal"===r?(0,s.jsx)(tt,{...h,ref:t,onThumbPositionChange:()=>{if(i.viewport&&l.current){let e=tx(i.viewport.scrollLeft,d,i.dir);l.current.style.transform=`translate3d(${e}px, 0, 0)`}},onWheelScroll:e=>{i.viewport&&(i.viewport.scrollLeft=e)},onDragScroll:e=>{i.viewport&&(i.viewport.scrollLeft=f(e,i.dir))}}):"vertical"===r?(0,s.jsx)(tr,{...h,ref:t,onThumbPositionChange:()=>{if(i.viewport&&l.current){let e=tx(i.viewport.scrollTop,d);l.current.style.transform=`translate3d(0, ${e}px, 0)`}},onWheelScroll:e=>{i.viewport&&(i.viewport.scrollTop=e)},onDragScroll:e=>{i.viewport&&(i.viewport.scrollTop=f(e))}}):null}),tt=a.forwardRef((e,t)=>{let{sizes:r,onSizesChange:n,...i}=e,l=e1(e6,e.__scopeScrollArea),[o,d]=a.useState(),c=a.useRef(null),u=(0,eG.s)(t,c,l.onScrollbarXChange);return a.useEffect(()=>{c.current&&d(getComputedStyle(c.current))},[c]),(0,s.jsx)(tn,{"data-orientation":"horizontal",...i,ref:u,sizes:r,style:{bottom:0,left:"rtl"===l.dir?"var(--radix-scroll-area-corner-width)":0,right:"ltr"===l.dir?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":tm(r)+"px",...e.style},onThumbPointerDown:t=>e.onThumbPointerDown(t.x),onDragScroll:t=>e.onDragScroll(t.x),onWheelScroll:(t,r)=>{if(l.viewport){let s=l.viewport.scrollLeft+t.deltaX;e.onWheelScroll(s),function(e,t){return e>0&&e<t}(s,r)&&t.preventDefault()}},onResize:()=>{c.current&&l.viewport&&o&&n({content:l.viewport.scrollWidth,viewport:l.viewport.offsetWidth,scrollbar:{size:c.current.clientWidth,paddingStart:th(o.paddingLeft),paddingEnd:th(o.paddingRight)}})}})}),tr=a.forwardRef((e,t)=>{let{sizes:r,onSizesChange:n,...i}=e,l=e1(e6,e.__scopeScrollArea),[o,d]=a.useState(),c=a.useRef(null),u=(0,eG.s)(t,c,l.onScrollbarYChange);return a.useEffect(()=>{c.current&&d(getComputedStyle(c.current))},[c]),(0,s.jsx)(tn,{"data-orientation":"vertical",...i,ref:u,sizes:r,style:{top:0,right:"ltr"===l.dir?0:void 0,left:"rtl"===l.dir?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":tm(r)+"px",...e.style},onThumbPointerDown:t=>e.onThumbPointerDown(t.y),onDragScroll:t=>e.onDragScroll(t.y),onWheelScroll:(t,r)=>{if(l.viewport){let s=l.viewport.scrollTop+t.deltaY;e.onWheelScroll(s),function(e,t){return e>0&&e<t}(s,r)&&t.preventDefault()}},onResize:()=>{c.current&&l.viewport&&o&&n({content:l.viewport.scrollHeight,viewport:l.viewport.offsetHeight,scrollbar:{size:c.current.clientHeight,paddingStart:th(o.paddingTop),paddingEnd:th(o.paddingBottom)}})}})}),[ts,ta]=eQ(e6),tn=a.forwardRef((e,t)=>{let{__scopeScrollArea:r,sizes:n,hasThumb:i,onThumbChange:l,onThumbPointerUp:o,onThumbPointerDown:c,onThumbPositionChange:u,onDragScroll:h,onWheelScroll:m,onResize:x,...p}=e,g=e1(e6,r),[b,j]=a.useState(null),v=(0,eG.s)(t,e=>j(e)),w=a.useRef(null),y=a.useRef(""),N=g.viewport,A=n.content-n.viewport,S=(0,eV.c)(m),C=(0,eV.c)(u),k=tb(x,10);function E(e){w.current&&h({x:e.clientX-w.current.left,y:e.clientY-w.current.top})}return a.useEffect(()=>{let e=e=>{let t=e.target;b?.contains(t)&&S(e,A)};return document.addEventListener("wheel",e,{passive:!1}),()=>document.removeEventListener("wheel",e,{passive:!1})},[N,b,A,S]),a.useEffect(C,[n,C]),tj(b,k),tj(g.content,k),(0,s.jsx)(ts,{scope:r,scrollbar:b,hasThumb:i,onThumbChange:(0,eV.c)(l),onThumbPointerUp:(0,eV.c)(o),onThumbPositionChange:C,onThumbPointerDown:(0,eV.c)(c),children:(0,s.jsx)(f.sG.div,{...p,ref:v,style:{position:"absolute",...p.style},onPointerDown:(0,d.m)(e.onPointerDown,e=>{0===e.button&&(e.target.setPointerCapture(e.pointerId),w.current=b.getBoundingClientRect(),y.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",g.viewport&&(g.viewport.style.scrollBehavior="auto"),E(e))}),onPointerMove:(0,d.m)(e.onPointerMove,E),onPointerUp:(0,d.m)(e.onPointerUp,e=>{let t=e.target;t.hasPointerCapture(e.pointerId)&&t.releasePointerCapture(e.pointerId),document.body.style.webkitUserSelect=y.current,g.viewport&&(g.viewport.style.scrollBehavior=""),w.current=null})})})}),ti="ScrollAreaThumb",tl=a.forwardRef((e,t)=>{let{forceMount:r,...a}=e,n=ta(ti,e.__scopeScrollArea);return(0,s.jsx)(h.C,{present:r||n.hasThumb,children:(0,s.jsx)(to,{ref:t,...a})})}),to=a.forwardRef((e,t)=>{let{__scopeScrollArea:r,style:n,...i}=e,l=e1(ti,r),o=ta(ti,r),{onThumbPositionChange:c}=o,u=(0,eG.s)(t,e=>o.onThumbChange(e)),h=a.useRef(void 0),m=tb(()=>{h.current&&(h.current(),h.current=void 0)},100);return a.useEffect(()=>{let e=l.viewport;if(e){let t=()=>{m(),h.current||(h.current=tg(e,c),c())};return c(),e.addEventListener("scroll",t),()=>e.removeEventListener("scroll",t)}},[l.viewport,m,c]),(0,s.jsx)(f.sG.div,{"data-state":o.hasThumb?"visible":"hidden",...i,ref:u,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...n},onPointerDownCapture:(0,d.m)(e.onPointerDownCapture,e=>{let t=e.target.getBoundingClientRect(),r=e.clientX-t.left,s=e.clientY-t.top;o.onThumbPointerDown({x:r,y:s})}),onPointerUp:(0,d.m)(e.onPointerUp,o.onThumbPointerUp)})});tl.displayName=ti;var td="ScrollAreaCorner",tc=a.forwardRef((e,t)=>{let r=e1(td,e.__scopeScrollArea),a=!!(r.scrollbarX&&r.scrollbarY);return"scroll"!==r.type&&a?(0,s.jsx)(tu,{...e,ref:t}):null});tc.displayName=td;var tu=a.forwardRef((e,t)=>{let{__scopeScrollArea:r,...n}=e,i=e1(td,r),[l,o]=a.useState(0),[d,c]=a.useState(0),u=!!(l&&d);return tj(i.scrollbarX,()=>{let e=i.scrollbarX?.offsetHeight||0;i.onCornerHeightChange(e),c(e)}),tj(i.scrollbarY,()=>{let e=i.scrollbarY?.offsetWidth||0;i.onCornerWidthChange(e),o(e)}),u?(0,s.jsx)(f.sG.div,{...n,ref:t,style:{width:l,height:d,position:"absolute",right:"ltr"===i.dir?0:void 0,left:"rtl"===i.dir?0:void 0,bottom:0,...e.style}}):null});function th(e){return e?parseInt(e,10):0}function tf(e,t){let r=e/t;return isNaN(r)?0:r}function tm(e){let t=tf(e.viewport,e.content),r=e.scrollbar.paddingStart+e.scrollbar.paddingEnd;return Math.max((e.scrollbar.size-r)*t,18)}function tx(e,t,r="ltr"){let s=tm(t),a=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,n=t.scrollbar.size-a,i=t.content-t.viewport,l=(0,eZ.q)(e,"ltr"===r?[0,i]:[-1*i,0]);return tp([0,i],[0,n-s])(l)}function tp(e,t){return r=>{if(e[0]===e[1]||t[0]===t[1])return t[0];let s=(t[1]-t[0])/(e[1]-e[0]);return t[0]+s*(r-e[0])}}var tg=(e,t=()=>{})=>{let r={left:e.scrollLeft,top:e.scrollTop},s=0;return!function a(){let n={left:e.scrollLeft,top:e.scrollTop},i=r.left!==n.left,l=r.top!==n.top;(i||l)&&t(),r=n,s=window.requestAnimationFrame(a)}(),()=>window.cancelAnimationFrame(s)};function tb(e,t){let r=(0,eV.c)(e),s=a.useRef(0);return a.useEffect(()=>()=>window.clearTimeout(s.current),[]),a.useCallback(()=>{window.clearTimeout(s.current),s.current=window.setTimeout(r,t)},[r,t])}function tj(e,t){let r=(0,eV.c)(t);(0,eW.N)(()=>{let t=0;if(e){let s=new ResizeObserver(()=>{cancelAnimationFrame(t),t=window.requestAnimationFrame(r)});return s.observe(e),()=>{window.cancelAnimationFrame(t),s.unobserve(e)}}},[e,r])}let tv=a.forwardRef(({className:e,children:t,...r},a)=>(0,s.jsxs)(e2,{ref:a,className:(0,L.cn)("relative overflow-hidden",e),...r,children:[(0,s.jsx)(e5,{className:"h-full w-full rounded-[inherit]",children:t}),(0,s.jsx)(tw,{}),(0,s.jsx)(tc,{})]}));tv.displayName=e2.displayName;let tw=a.forwardRef(({className:e,orientation:t="vertical",...r},a)=>(0,s.jsx)(e3,{ref:a,orientation:t,className:(0,L.cn)("flex touch-none select-none transition-colors","vertical"===t&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===t&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...r,children:(0,s.jsx)(tl,{className:"relative flex-1 rounded-full bg-border"})}));tw.displayName=e3.displayName;let ty=eu.Ik({id:eu.Yj(),value:eu.Yj().min(1,"Option text cannot be empty")}),tN=eu.Ik({id:eu.Yj(),text:eu.Yj().min(3,"Question text must be at least 3 characters"),type:eu.k5(["short-answer","yes-no","rating","multiple-choice"]),options:eu.YO(ty).optional()}),tA=eu.Ik({title:eu.Yj().min(3,"Title must be at least 3 characters"),questions:eu.YO(tN).min(1,"You must add at least one question")});function tS(){let[e,t]=(0,a.useState)({totalUsers:0,newUsers7Days:0,totalOpenHouses:0,newOpenHouses7Days:0,totalGifts:0,newGifts7Days:0}),[r,d]=(0,a.useState)([]),[c,u]=(0,a.useState)([]),[h,f]=(0,a.useState)([]),[m,x]=(0,a.useState)([]),[p,g]=(0,a.useState)({}),[b,j]=(0,a.useState)(null),[v,w]=(0,a.useState)(!0),{toast:y}=(0,I.dj)(),[A,S]=(0,a.useState)(""),[C,k]=(0,a.useState)(""),[E,R]=(0,a.useState)(""),[D,T]=(0,a.useState)(!1),[L,H]=(0,a.useState)(null),[Y,eu]=(0,a.useState)(!1),[ej,eG]=(0,a.useState)(null),[eP,e_]=(0,a.useState)([]),[eI,eF]=(0,a.useState)([]),[eU,eH]=(0,a.useState)(!0),[eB,eq]=(0,a.useState)(!0),[ez,eO]=(0,a.useState)([]),[e$,eY]=(0,a.useState)([]),[eV,eW]=(0,a.useState)(!1),[eZ,eK]=(0,a.useState)(!1),[eQ,eJ]=(0,a.useState)(null),e0=e=>{if(!e)return"??";let t=e.split(" ");return t.length>1?(t[0][0]+t[t.length-1][0]).toUpperCase():e.substring(0,2).toUpperCase()},e1=(0,a.useCallback)(async()=>{w(!0),eH(!0),eq(!0);try{let{stats:e,users:r,openHouses:s,forms:a,settings:n}=await ev();t(e),d(r),u(s),f(a),g(n),eO(n.giftbit?.enabledRegionCodes||[]),eY(n.giftbit?.enabledBrandCodes||[]);let{regions:i,brands:l}=await ew();e_(i),eF(l),eH(!1);let o=await ey();x(o),eq(!1);let c=await eN();j(c)}catch(e){console.error("Error fetching admin data:",e),y({variant:"destructive",title:"Error",description:"Could not fetch admin data. You might not have the required permissions."})}w(!1)},[y]),e2=(0,ed.mN)({resolver:(0,ec.u)(tA),defaultValues:{title:"",questions:[]}}),{fields:e4,append:e5,remove:e6,update:e3,move:e9}=(0,ed.jz)({control:e2.control,name:"questions"}),e7=e2.watch("questions"),e8=e=>{let t=e2.getValues(`questions.${e}`),r=[...t.options||[],{id:(0,ex.A)(),value:""}];e3(e,{...t,options:r})},te=(e,t)=>{let r=e2.getValues(`questions.${e}`),s=r.options?.filter((e,r)=>r!==t);e3(e,{...r,options:s})};async function tt(e){try{if(L){let t=(0,n.H9)(i.db,"feedbackForms",L.id);await (0,n.mZ)(t,{title:e.title,questions:e.questions})}else await (0,n.gS)((0,n.collection)(i.db,"feedbackForms"),{...e,type:"global",createdAt:n.Dc.now()});ta(),await e1()}catch(e){console.error("Error saving form:",e),y({variant:"destructive",title:"Error",description:"Could not save the form."})}}let tr=async()=>{if(ej)try{await (0,n.kd)((0,n.H9)(i.db,"feedbackForms",ej)),await e1()}catch(e){console.error("Error deleting form:",e),y({variant:"destructive",title:"Delete Failed",description:"Could not delete the form."})}finally{eu(!1),eG(null)}},ts=e=>{H(e||null),T(!0)},ta=()=>{T(!1),H(null),e2.reset()},tn=e=>{eG(e),eu(!0)},ti=e=>{eJ(e),eK(!0)},tl=async e=>{try{let t=(0,n.H9)(i.db,"settings","appDefaults");await (0,n.BN)(t,{defaultGlobalFormId:e},{merge:!0}),g(t=>({...t,defaultGlobalFormId:e})),y({title:"Default Form Set",description:"New users will now receive this form by default."})}catch(e){console.error("Error setting default form:",e),y({variant:"destructive",title:"Error",description:"Could not set the default form."})}},to=(e,t)=>{eO(r=>t?[...r,e]:r.filter(t=>t!==e))},td=(e,t)=>{eY(r=>t?[...r,e]:r.filter(t=>t!==e))},tc=async()=>{eW(!0);let e=await eA({enabledRegionCodes:ez,enabledBrandCodes:e$});e.success?y({title:"Giftbit settings saved successfully!"}):y({variant:"destructive",title:"Error",description:e.message}),eW(!1)},tu=async()=>{if(!eQ)return;let e=await eS(eQ.id);e.success?(y({title:"Success",description:e.message}),await e1()):y({variant:"destructive",title:"Cancellation Failed",description:e.message}),eK(!1),eJ(null)},th=(0,a.useMemo)(()=>r.filter(e=>e.name?.toLowerCase().includes(A.toLowerCase())||e.email?.toLowerCase().includes(A.toLowerCase())),[r,A]),tf=(0,a.useMemo)(()=>{let e=new Map(r.map(e=>[e.id,e]));return c.map(t=>({...t,userName:e.get(t.userId)?.name||"Unknown User"})).filter(e=>e.address.toLowerCase().includes(C.toLowerCase())||e.userName.toLowerCase().includes(C.toLowerCase()))},[c,C,r]),tm=(0,a.useMemo)(()=>0===ez.length?[]:eI.filter(e=>e.region_codes.some(e=>ez.includes(e))).sort((e,t)=>e.name.localeCompare(t.name)),[eI,ez]),tx=(0,a.useMemo)(()=>m.filter(e=>e.recipientName.toLowerCase().includes(E.toLowerCase())||e.recipientEmail.toLowerCase().includes(E.toLowerCase())||e.senderName.toLowerCase().includes(E.toLowerCase())||e.senderEmail.toLowerCase().includes(E.toLowerCase())||e.brandCode.toLowerCase().includes(E.toLowerCase())),[m,E]),tp=e=>"number"!=typeof e?"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e/100),tg=e=>{if(!e)return"N/A";let t="string"==typeof e?new Date(e):e.toDate();return(0,eC.GP)(t,"MMM d, yyyy")},tb=e=>{if(!e)return"N/A";let t="string"==typeof e?new Date(e):e.toDate();return(0,eC.GP)(t,"MMM d, yyyy p")},tj=e=>{var t,r;return e?(r={addSuffix:!0},function(e,t,r){let s,a,n,i=(0,eL.q)(),l=r?.locale??i.locale??eT.c,o=eR(e,t);if(isNaN(o))throw RangeError("Invalid time value");let d=Object.assign({},r,{addSuffix:r?.addSuffix,comparison:o});o>0?(s=(0,eE.a)(t),a=(0,eE.a)(e)):(s=(0,eE.a)(e),a=(0,eE.a)(t));let c=function(e,t,r){var s;return(s=void 0,e=>{let t=(s?Math[s]:Math.trunc)(e);return 0===t?0:t})(((0,eE.a)(e)-(0,eE.a)(t))/1e3)}(a,s),u=Math.round((c-((0,eM.G)(a)-(0,eM.G)(s))/1e3)/60);if(u<2)if(r?.includeSeconds)if(c<5)return l.formatDistance("lessThanXSeconds",5,d);else if(c<10)return l.formatDistance("lessThanXSeconds",10,d);else if(c<20)return l.formatDistance("lessThanXSeconds",20,d);else if(c<40)return l.formatDistance("halfAMinute",0,d);else if(c<60)return l.formatDistance("lessThanXMinutes",1,d);else return l.formatDistance("xMinutes",1,d);else if(0===u)return l.formatDistance("lessThanXMinutes",1,d);else return l.formatDistance("xMinutes",u,d);if(u<45)return l.formatDistance("xMinutes",u,d);if(u<90)return l.formatDistance("aboutXHours",1,d);if(u<eD.F6){let e=Math.round(u/60);return l.formatDistance("aboutXHours",e,d)}if(u<2520)return l.formatDistance("xDays",1,d);else if(u<eD.Nw){let e=Math.round(u/eD.F6);return l.formatDistance("xDays",e,d)}else if(u<2*eD.Nw)return n=Math.round(u/eD.Nw),l.formatDistance("aboutXMonths",n,d);if((n=function(e,t){let r,s=(0,eE.a)(e),a=(0,eE.a)(t),n=eR(s,a),i=Math.abs(function(e,t){let r=(0,eE.a)(e),s=(0,eE.a)(t);return 12*(r.getFullYear()-s.getFullYear())+(r.getMonth()-s.getMonth())}(s,a));if(i<1)r=0;else{1===s.getMonth()&&s.getDate()>27&&s.setDate(30),s.setMonth(s.getMonth()-n*i);let t=eR(s,a)===-n;(function(e){let t=(0,eE.a)(e);return+function(e){let t=(0,eE.a)(e);return t.setHours(23,59,59,999),t}(t)==+function(e){let t=(0,eE.a)(e),r=t.getMonth();return t.setFullYear(t.getFullYear(),r+1,0),t.setHours(23,59,59,999),t}(t)})((0,eE.a)(e))&&1===i&&1===eR(e,a)&&(t=!1),r=n*(i-Number(t))}return 0===r?0:r}(a,s))<12){let e=Math.round(u/eD.Nw);return l.formatDistance("xMonths",e,d)}{let e=n%12,t=Math.trunc(n/12);return e<3?l.formatDistance("aboutXYears",t,d):e<9?l.formatDistance("overXYears",t,d):l.formatDistance("almostXYears",t+1,d)}}(t="string"==typeof e?new Date(e):e.toDate(),(0,ek.w)(t,Date.now()),r)):"N/A"},tw=({title:e,value:t,subtext:r,icon:a,isLoading:n})=>(0,s.jsxs)(l.Zp,{children:[(0,s.jsxs)(l.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,s.jsx)(l.ZB,{className:"text-sm font-medium",children:e}),a]}),(0,s.jsxs)(l.Wu,{children:[n?(0,s.jsx)("div",{className:"h-7 w-24 bg-muted animate-pulse rounded-md"}):(0,s.jsx)("div",{className:"text-2xl font-bold",children:t}),r&&(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:r})]})]});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"w-full mx-auto space-y-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold tracking-tight font-headline",children:"Admin Dashboard"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Oversee users, forms, and platform settings."})]}),(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,s.jsx)(tw,{title:"Total Users",value:e.totalUsers,subtext:`${e.newUsers7Days} new in last 7 days`,icon:(0,s.jsx)(z.A,{className:"h-4 w-4 text-muted-foreground"}),isLoading:v}),(0,s.jsx)(tw,{title:"Total Open Houses",value:e.totalOpenHouses,subtext:`${e.newOpenHouses7Days} new in last 7 days`,icon:(0,s.jsx)(O.A,{className:"h-4 w-4 text-muted-foreground"}),isLoading:v}),(0,s.jsx)(tw,{title:"Total Gifts Sent",value:e.totalGifts,subtext:`${e.newGifts7Days} in last 7 days`,icon:(0,s.jsx)($.A,{className:"h-4 w-4 text-muted-foreground"}),isLoading:v}),(0,s.jsx)(tw,{title:"Giftbit Balance",value:tp(b??void 0),icon:(0,s.jsx)(X,{className:"h-4 w-4 text-muted-foreground"}),isLoading:null===b})]}),(0,s.jsxs)(N,{defaultValue:"users",className:"w-full",children:[(0,s.jsxs)(M,{className:"grid w-full grid-cols-1 sm:grid-cols-2 md:grid-cols-5 h-auto md:h-10",children:[(0,s.jsx)(G,{value:"users",children:"All Users"}),(0,s.jsx)(G,{value:"openHouses",children:"Open Houses"}),(0,s.jsx)(G,{value:"allGifts",children:"All Gifts"}),(0,s.jsx)(G,{value:"formLibrary",children:"Form Library"}),(0,s.jsx)(G,{value:"giftBrands",children:"Gift Brands"})]}),(0,s.jsx)(P,{value:"users",children:(0,s.jsxs)(l.Zp,{children:[(0,s.jsx)(l.aR,{children:(0,s.jsxs)("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4",children:[(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsx)(l.ZB,{children:"All Users"}),(0,s.jsx)(l.BT,{children:"A list of all registered users on the platform."})]}),(0,s.jsx)(F.p,{placeholder:"Search by name or email...",value:A,onChange:e=>S(e.target.value),className:"w-full md:w-64"})]})}),(0,s.jsx)(l.Wu,{children:v?(0,s.jsx)("p",{children:"Loading users..."}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"md:hidden space-y-4",children:th.length>0?th.map(e=>(0,s.jsxs)(l.Zp,{children:[(0,s.jsx)(l.aR,{children:(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsxs)(_.eu,{children:[(0,s.jsx)(_.BK,{src:e.photoURL||"",alt:e.name||"avatar","data-ai-hint":"person avatar"}),(0,s.jsx)(_.q5,{children:e0(e.name)})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(l.ZB,{className:"text-base",children:e.name}),(0,s.jsx)(l.BT,{children:e.email})]})]})}),(0,s.jsxs)(l.Wu,{className:"space-y-2 text-sm",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsxs)("span",{className:"text-muted-foreground flex items-center gap-1",children:[(0,s.jsx)(V.A,{className:"w-4 h-4"})," Role:"]}),e.isAdmin?(0,s.jsx)(q.E,{children:"Admin"}):(0,s.jsx)(q.E,{variant:"secondary",children:"User"})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsxs)("span",{className:"text-muted-foreground flex items-center gap-1",children:[(0,s.jsx)(W,{className:"w-4 h-4"})," Balance:"]}),(0,s.jsx)("span",{className:"font-medium",children:tp(e.availableBalance)})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsxs)("span",{className:"text-muted-foreground flex items-center gap-1",children:[(0,s.jsx)(Z,{className:"w-4 h-4"})," User Since:"]}),(0,s.jsx)("span",{className:"font-medium",children:tg(e.createdAt)})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsxs)("span",{className:"text-muted-foreground flex items-center gap-1",children:[(0,s.jsx)(K,{className:"w-4 h-4"})," Last Activity:"]}),(0,s.jsx)("span",{className:"font-medium",children:tb(e.lastLoginAt)})]})]})]},e.id)):(0,s.jsx)("div",{className:"h-24 text-center flex items-center justify-center",children:(0,s.jsx)("p",{children:"No users found."})})}),(0,s.jsx)("div",{className:"border rounded-lg hidden md:block overflow-x-auto",children:(0,s.jsxs)(o.XI,{children:[(0,s.jsx)(o.A0,{children:(0,s.jsxs)(o.Hj,{children:[(0,s.jsx)(o.nd,{children:"User"}),(0,s.jsx)(o.nd,{children:"Email"}),(0,s.jsx)(o.nd,{children:"Role"}),(0,s.jsx)(o.nd,{children:"Balance"}),(0,s.jsx)(o.nd,{children:"User Since"}),(0,s.jsx)(o.nd,{children:"Last Activity"})]})}),(0,s.jsx)(o.BF,{children:th.length>0?th.map(e=>(0,s.jsxs)(o.Hj,{children:[(0,s.jsx)(o.nA,{children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)(_.eu,{children:[(0,s.jsx)(_.BK,{src:e.photoURL||"",alt:e.name||"avatar","data-ai-hint":"person avatar"}),(0,s.jsx)(_.q5,{children:e0(e.name)})]}),(0,s.jsx)("div",{children:(0,s.jsx)("p",{className:"font-medium",children:e.name})})]})}),(0,s.jsx)(o.nA,{children:e.email}),(0,s.jsx)(o.nA,{children:e.isAdmin?(0,s.jsx)(q.E,{children:"Admin"}):(0,s.jsx)(q.E,{variant:"secondary",children:"User"})}),(0,s.jsx)(o.nA,{children:tp(e.availableBalance)}),(0,s.jsx)(o.nA,{children:tg(e.createdAt)}),(0,s.jsx)(o.nA,{children:tb(e.lastLoginAt)})]},e.id)):(0,s.jsx)(o.Hj,{children:(0,s.jsx)(o.nA,{colSpan:6,className:"h-24 text-center",children:"No users found."})})})]})})]})})]})}),(0,s.jsx)(P,{value:"openHouses",children:(0,s.jsxs)(l.Zp,{children:[(0,s.jsx)(l.aR,{children:(0,s.jsxs)("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4",children:[(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsx)(l.ZB,{children:"All Open Houses"}),(0,s.jsx)(l.BT,{children:"A list of all open houses created by users."})]}),(0,s.jsx)(F.p,{placeholder:"Search by address or user...",value:C,onChange:e=>k(e.target.value),className:"w-full md:w-64"})]})}),(0,s.jsx)(l.Wu,{children:v?(0,s.jsx)("p",{children:"Loading open houses..."}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"md:hidden space-y-4",children:tf.length>0?tf.map(e=>(0,s.jsxs)(l.Zp,{children:[(0,s.jsx)(l.aR,{children:(0,s.jsxs)("div",{className:"flex items-start gap-4",children:[(0,s.jsx)(B(),{href:`/user/open-house/${e.id}`,children:(0,s.jsx)("div",{className:"w-24 h-16 relative rounded-md overflow-hidden border flex-shrink-0 bg-muted",children:e.imageUrl?(0,s.jsx)(U.default,{src:e.imageUrl,alt:`Image of ${e.address}`,fill:!0,className:"object-cover","data-ai-hint":"house exterior"}):(0,s.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,s.jsx)(O.A,{className:"w-8 h-8 text-muted-foreground"})})})}),(0,s.jsxs)("div",{className:"flex-grow",children:[(0,s.jsx)(l.ZB,{className:"text-base leading-tight",children:(0,s.jsx)(B(),{href:`/user/open-house/${e.id}`,className:"hover:underline",children:e.address})}),(0,s.jsx)(l.BT,{className:"mt-1",children:e.userName})]})]})}),(0,s.jsx)(l.wL,{children:e.isActive?(0,s.jsx)(q.E,{className:"bg-green-600 text-white hover:bg-green-600",children:"Active"}):(0,s.jsx)(q.E,{variant:"outline",children:"Inactive"})})]},e.id)):(0,s.jsx)("div",{className:"h-24 text-center flex items-center justify-center",children:(0,s.jsx)("p",{children:"No open houses found."})})}),(0,s.jsx)("div",{className:"border rounded-lg hidden md:block overflow-x-auto",children:(0,s.jsxs)(o.XI,{children:[(0,s.jsx)(o.A0,{children:(0,s.jsxs)(o.Hj,{children:[(0,s.jsx)(o.nd,{children:"Property"}),(0,s.jsx)(o.nd,{children:"Address"}),(0,s.jsx)(o.nd,{children:"Created By"}),(0,s.jsx)(o.nd,{children:"Status"})]})}),(0,s.jsx)(o.BF,{children:tf.length>0?tf.map(e=>(0,s.jsxs)(o.Hj,{children:[(0,s.jsx)(o.nA,{children:(0,s.jsx)(B(),{href:`/user/open-house/${e.id}`,children:(0,s.jsx)("div",{className:"w-24 h-16 relative rounded-md overflow-hidden border flex-shrink-0 bg-muted",children:e.imageUrl?(0,s.jsx)(U.default,{src:e.imageUrl,alt:`Image of ${e.address}`,fill:!0,className:"object-cover","data-ai-hint":"house exterior"}):(0,s.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,s.jsx)(O.A,{className:"w-8 h-8 text-muted-foreground"})})})})}),(0,s.jsx)(o.nA,{children:(0,s.jsx)(B(),{href:`/user/open-house/${e.id}`,className:"hover:underline font-medium block max-w-xs truncate",children:e.address})}),(0,s.jsx)(o.nA,{children:e.userName}),(0,s.jsx)(o.nA,{children:e.isActive?(0,s.jsx)(q.E,{className:"bg-green-600 text-white hover:bg-green-600",children:"Active"}):(0,s.jsx)(q.E,{variant:"outline",children:"Inactive"})})]},e.id)):(0,s.jsx)(o.Hj,{children:(0,s.jsx)(o.nA,{colSpan:4,className:"h-24 text-center",children:"No open houses found."})})})]})})]})})]})}),(0,s.jsx)(P,{value:"allGifts",children:(0,s.jsxs)(l.Zp,{children:[(0,s.jsx)(l.aR,{children:(0,s.jsxs)("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4",children:[(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsx)(l.ZB,{children:"All Gifts"}),(0,s.jsx)(l.BT,{children:"A complete log of all gifts created by all users."})]}),(0,s.jsx)(F.p,{placeholder:"Search gifts...",value:E,onChange:e=>R(e.target.value),className:"w-full md:w-64"})]})}),(0,s.jsx)(l.Wu,{children:eB?(0,s.jsx)("div",{className:"flex justify-center items-center h-48",children:(0,s.jsx)(Q.A,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):(0,s.jsx)("div",{className:"border rounded-lg overflow-x-auto",children:(0,s.jsxs)(o.XI,{children:[(0,s.jsx)(o.A0,{children:(0,s.jsxs)(o.Hj,{children:[(0,s.jsx)(o.nd,{children:"Recipient"}),(0,s.jsx)(o.nd,{children:"Amount"}),(0,s.jsx)(o.nd,{children:"Sender"}),(0,s.jsx)(o.nd,{children:"DB Status"}),(0,s.jsx)(o.nd,{children:"Giftbit Status"}),(0,s.jsx)(o.nd,{children:"Created"}),(0,s.jsx)(o.nd,{className:"text-right",children:"Actions"})]})}),(0,s.jsx)(o.BF,{children:tx.length>0?tx.map(e=>{let t=e.giftbitStatus&&!["REDEEMED","CANCELLED"].includes(e.giftbitStatus);return(0,s.jsxs)(o.Hj,{children:[(0,s.jsxs)(o.nA,{children:[(0,s.jsx)("div",{className:"font-medium",children:e.recipientName}),(0,s.jsx)("div",{className:"text-sm text-muted-foreground",children:e.recipientEmail})]}),(0,s.jsx)(o.nA,{children:tp(e.amountInCents)}),(0,s.jsx)(o.nA,{children:e.senderName}),(0,s.jsx)(o.nA,{children:(0,s.jsx)(q.E,{variant:"Sent"===e.status?"default":"Failed"===e.status?"destructive":"Cancelled"===e.status?"outline":"secondary",children:e.status})}),(0,s.jsx)(o.nA,{children:e.giftbitStatus?(0,s.jsx)(q.E,{variant:"outline",children:e.giftbitStatus.replace(/_/g," ")}):(0,s.jsx)("span",{className:"text-muted-foreground text-xs",children:"N/A"})}),(0,s.jsx)(o.nA,{title:tb(e.createdAt),children:tj(e.createdAt)}),(0,s.jsx)(o.nA,{className:"text-right",children:(0,s.jsxs)(eg.rI,{children:[(0,s.jsx)(eg.ty,{asChild:!0,children:(0,s.jsxs)(el.$,{variant:"ghost",size:"icon",children:[(0,s.jsx)(J.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Gift Actions"})]})}),(0,s.jsxs)(eg.SQ,{align:"end",children:[e.claimUrl&&(0,s.jsxs)(eg._2,{onClick:()=>navigator.clipboard.writeText(e.claimUrl||""),children:[(0,s.jsx)(ee.A,{className:"mr-2 h-4 w-4"}),(0,s.jsx)("span",{children:"Copy Claim Link"})]}),t&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eg.mB,{}),(0,s.jsxs)(eg._2,{onClick:()=>ti(e),className:"text-destructive focus:text-destructive",children:[(0,s.jsx)(et,{className:"mr-2 h-4 w-4"}),(0,s.jsx)("span",{children:"Cancel Gift"})]})]})]})]})})]},e.id)}):(0,s.jsx)(o.Hj,{children:(0,s.jsx)(o.nA,{colSpan:7,className:"h-24 text-center",children:"No gifts found."})})})]})})})]})}),(0,s.jsx)(P,{value:"formLibrary",children:(0,s.jsxs)(l.Zp,{children:[(0,s.jsxs)(l.aR,{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[(0,s.jsxs)("div",{className:"w-full",children:[(0,s.jsx)(l.ZB,{children:"Form Library"}),(0,s.jsx)(l.BT,{children:"Manage feedback forms in the library that all users can access."})]}),(0,s.jsxs)(el.$,{onClick:()=>ts(),className:"w-full sm:w-auto",children:[(0,s.jsx)(er.A,{className:"mr-2"})," Create New Form"]})]}),(0,s.jsx)(l.Wu,{children:v?(0,s.jsx)("p",{children:"Loading forms..."}):h.length>0?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"mb-6 bg-muted/50 p-4 rounded-lg",children:[(0,s.jsx)("label",{className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",htmlFor:"default-form-select",children:"Default Form for New Users"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:"This form will be the default for all new users upon sign-up."}),(0,s.jsxs)(em.l6,{onValueChange:tl,value:p.defaultGlobalFormId,children:[(0,s.jsx)(em.bq,{id:"default-form-select",className:"w-full max-w-sm",children:(0,s.jsx)(em.yv,{placeholder:"Select a default form..."})}),(0,s.jsx)(em.gC,{children:h.map(e=>(0,s.jsx)(em.eb,{value:e.id,children:e.title},e.id))})]})]}),(0,s.jsx)("div",{className:"border rounded-lg overflow-x-auto",children:(0,s.jsxs)(o.XI,{children:[(0,s.jsx)(o.A0,{children:(0,s.jsxs)(o.Hj,{children:[(0,s.jsx)(o.nd,{children:"Title"}),(0,s.jsx)(o.nd,{children:"Questions"}),(0,s.jsx)(o.nd,{className:"w-[100px] text-right",children:"Actions"})]})}),(0,s.jsx)(o.BF,{children:h.map(e=>(0,s.jsxs)(o.Hj,{children:[(0,s.jsxs)(o.nA,{className:"font-medium flex items-center gap-2",children:[e.title,e.id===p.defaultGlobalFormId&&(0,s.jsx)(q.E,{variant:"secondary",children:"Default"})]}),(0,s.jsx)(o.nA,{children:e.questions.length}),(0,s.jsx)(o.nA,{className:"text-right",children:(0,s.jsxs)(eg.rI,{children:[(0,s.jsx)(eg.ty,{asChild:!0,children:(0,s.jsxs)(el.$,{variant:"ghost",size:"icon",children:[(0,s.jsx)(J.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Form Actions"})]})}),(0,s.jsxs)(eg.SQ,{align:"end",children:[(0,s.jsxs)(eg._2,{onClick:()=>ts(e),children:[(0,s.jsx)(es.A,{className:"mr-2 h-4 w-4"}),(0,s.jsx)("span",{children:"Edit"})]}),(0,s.jsxs)(eg._2,{onClick:()=>tn(e.id),className:"text-destructive focus:text-destructive",children:[(0,s.jsx)(ea.A,{className:"mr-2 h-4 w-4"}),(0,s.jsx)("span",{children:"Delete"})]})]})]})})]},e.id))})]})})]}):(0,s.jsxs)("div",{className:"text-center py-16 border-2 border-dashed rounded-lg",children:[(0,s.jsx)("h3",{className:"text-xl font-medium",children:"No Forms in Library"}),(0,s.jsx)("p",{className:"text-muted-foreground mt-2",children:'Click "Create New Form" to build a new form for the library.'})]})})]})}),(0,s.jsx)(P,{value:"giftBrands",children:(0,s.jsxs)(l.Zp,{children:[(0,s.jsx)(l.aR,{children:(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(l.ZB,{children:"Gift Brands"}),(0,s.jsx)(l.BT,{children:"Configure which gift card regions and brands are available to users."})]}),(0,s.jsxs)(el.$,{onClick:tc,disabled:eV,className:"w-full sm:w-auto",children:[eV&&(0,s.jsx)(Q.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Save Changes"]})]})}),(0,s.jsx)(l.Wu,{children:eU?(0,s.jsx)("div",{className:"flex justify-center items-center h-48",children:(0,s.jsx)(Q.A,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 items-start",children:[(0,s.jsxs)("div",{className:"md:col-span-1 space-y-4",children:[(0,s.jsx)("h3",{className:"text-lg font-medium",children:"Enabled Regions"}),(0,s.jsx)("div",{className:"space-y-3",children:eP.map(e=>(0,s.jsxs)("div",{className:"flex items-center space-x-2 p-3 rounded-md hover:bg-muted/50",children:[(0,s.jsx)(eX,{id:`region-${e.code}`,checked:ez.includes(e.code),onCheckedChange:t=>to(e.code,t)}),(0,s.jsxs)("label",{htmlFor:`region-${e.code}`,className:"text-sm font-medium leading-none flex-grow cursor-pointer",children:[e.name," (",e.currency,")"]})]},e.code))})]}),(0,s.jsxs)("div",{className:"md:col-span-2",children:[(0,s.jsx)("h3",{className:"text-lg font-medium mb-4",children:"Enabled Brands"}),(0,s.jsxs)(tv,{className:"h-[500px] border rounded-lg p-4",children:[(0,s.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:tm.map(e=>(0,s.jsxs)("div",{className:"flex items-start space-x-3 p-3 rounded-md hover:bg-muted/50",children:[(0,s.jsx)(eX,{id:`brand-${e.brand_code}`,checked:e$.includes(e.brand_code),onCheckedChange:t=>td(e.brand_code,t),className:"mt-1"}),(0,s.jsxs)("label",{htmlFor:`brand-${e.brand_code}`,className:"flex flex-col gap-2 cursor-pointer",children:[(0,s.jsx)("div",{className:"w-20 h-10 relative bg-white rounded border flex items-center justify-center",children:(0,s.jsx)(U.default,{src:e.image_url,alt:e.name,fill:!0,className:"object-contain p-1","data-ai-hint":"company logo"})}),(0,s.jsx)("span",{className:"text-sm font-medium leading-none",children:e.name})]})]},e.brand_code))}),0===ez.length&&(0,s.jsx)("div",{className:"text-center py-10 text-muted-foreground",children:(0,s.jsx)("p",{children:"Select a region on the left to see available brands."})}),ez.length>0&&0===tm.length&&(0,s.jsx)("div",{className:"text-center py-10 text-muted-foreground",children:(0,s.jsx)("p",{children:"No brands available for the selected region(s)."})})]})]})]})})]})})]})]}),(0,s.jsx)(eo.lG,{open:D,onOpenChange:e=>!e&&ta(),children:(0,s.jsxs)(eo.Cf,{className:"max-w-3xl",children:[(0,s.jsxs)(eo.c7,{children:[(0,s.jsx)(eo.L3,{children:L?"Edit Form":"Create New Library Form"}),(0,s.jsx)(eo.rr,{children:L?"Modify the details of this form.":"Design a new feedback form for the library."})]}),(0,s.jsx)(eh.lV,{...e2,children:(0,s.jsxs)("form",{onSubmit:e2.handleSubmit(tt),children:[(0,s.jsxs)("div",{className:"space-y-6 p-1 max-h-[60vh] overflow-y-auto",children:[(0,s.jsx)(eh.zB,{control:e2.control,name:"title",render:({field:e})=>(0,s.jsxs)(eh.eI,{children:[(0,s.jsx)(eh.lR,{children:"Form Title"}),(0,s.jsx)(eh.MJ,{children:(0,s.jsx)(F.p,{placeholder:"e.g., General Property Feedback",...e})}),(0,s.jsx)(eh.C5,{})]})}),(0,s.jsx)(ep.w,{}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,s.jsx)("h3",{className:"text-lg font-medium",children:"Questions"})}),(0,s.jsx)("div",{className:"space-y-4",children:e4.map((e,t)=>(0,s.jsx)(l.Zp,{className:"p-4 bg-blue-50 dark:bg-blue-950/20 border-blue-200 dark:border-blue-900/50 relative transition-all",children:(0,s.jsxs)("div",{className:"flex justify-between items-start gap-4",children:[(0,s.jsxs)("div",{className:"flex-grow space-y-4",children:[(0,s.jsx)(eh.zB,{control:e2.control,name:`questions.${t}.text`,render:({field:e})=>(0,s.jsxs)(eh.eI,{children:[(0,s.jsxs)(eh.lR,{children:["Question ",t+1]}),(0,s.jsx)(eh.MJ,{children:(0,s.jsx)(ef.T,{placeholder:"What would you like to ask?",...e})}),(0,s.jsx)(eh.C5,{})]})}),(0,s.jsx)(eh.zB,{control:e2.control,name:`questions.${t}.type`,render:({field:e})=>(0,s.jsxs)(eh.eI,{children:[(0,s.jsx)(eh.lR,{children:"Question Type"}),(0,s.jsxs)(em.l6,{onValueChange:e.onChange,defaultValue:e.value,children:[(0,s.jsx)(eh.MJ,{children:(0,s.jsx)(em.bq,{children:(0,s.jsx)(em.yv,{placeholder:"Select a question type"})})}),(0,s.jsxs)(em.gC,{children:[(0,s.jsx)(em.eb,{value:"short-answer",children:"Short Answer"}),(0,s.jsx)(em.eb,{value:"yes-no",children:"Yes/No"}),(0,s.jsx)(em.eb,{value:"rating",children:"1-5 Rating"}),(0,s.jsx)(em.eb,{value:"multiple-choice",children:"Multiple Choice"})]})]}),(0,s.jsx)(eh.C5,{})]})}),e7[t]?.type==="multiple-choice"&&(0,s.jsxs)("div",{className:"space-y-3 pl-4 border-l-2 ml-2",children:[(0,s.jsx)(eh.lR,{children:"Options"}),e7[t].options?.map((e,r)=>(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(eh.zB,{control:e2.control,name:`questions.${t}.options.${r}.value`,render:({field:e})=>(0,s.jsxs)(eh.eI,{className:"flex-grow",children:[(0,s.jsx)(eh.MJ,{children:(0,s.jsx)(F.p,{placeholder:`Option ${r+1}`,...e})}),(0,s.jsx)(eh.C5,{})]})}),(0,s.jsx)(el.$,{variant:"ghost",size:"icon",onClick:()=>te(t,r),type:"button",children:(0,s.jsx)(ea.A,{className:"w-4 h-4 text-destructive"})})]},e.id)),(0,s.jsxs)(el.$,{size:"sm",variant:"outline",type:"button",onClick:()=>e8(t),children:[(0,s.jsx)(er.A,{className:"mr-2"})," Add Option"]})]})]}),(0,s.jsxs)("div",{className:"absolute top-2 right-2 flex flex-col gap-1",children:[(0,s.jsx)(el.$,{variant:"ghost",size:"icon",onClick:()=>e9(t,t-1),disabled:0===t,type:"button","aria-label":"Move up",children:(0,s.jsx)(en.A,{className:"w-4 h-4"})}),(0,s.jsx)(el.$,{variant:"ghost",size:"icon",onClick:()=>e9(t,t+1),disabled:t===e4.length-1,type:"button","aria-label":"Move down",children:(0,s.jsx)(ei.A,{className:"w-4 h-4"})}),(0,s.jsx)(el.$,{variant:"ghost",size:"icon",onClick:()=>e6(t),type:"button","aria-label":"Delete question",className:"text-destructive hover:text-destructive",children:(0,s.jsx)(ea.A,{className:"w-4 h-4"})})]})]})},e.id))}),(0,s.jsx)(eh.C5,{children:e2.formState.errors.questions?.message}),(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsxs)(el.$,{size:"sm",variant:"secondary",onClick:()=>{e5({id:(0,ex.A)(),text:"",type:"short-answer",options:[]})},type:"button",children:[(0,s.jsx)(er.A,{className:"mr-2"})," Add Question"]})})]})]}),(0,s.jsxs)(eo.Es,{className:"mt-6 pt-4 border-t",children:[(0,s.jsx)(el.$,{type:"button",variant:"ghost",onClick:ta,children:"Cancel"}),(0,s.jsx)(el.$,{type:"submit",disabled:e2.formState.isSubmitting,children:e2.formState.isSubmitting?"Saving...":"Save Form"})]})]})})]})}),(0,s.jsx)(eb.Lt,{open:Y,onOpenChange:eu,children:(0,s.jsxs)(eb.EO,{children:[(0,s.jsxs)(eb.wd,{children:[(0,s.jsx)(eb.r7,{children:"Are you sure?"}),(0,s.jsx)(eb.$v,{children:"This action cannot be undone. This will permanently delete this form from the library."})]}),(0,s.jsxs)(eb.ck,{children:[(0,s.jsx)(eb.Zr,{onClick:()=>eG(null),children:"Cancel"}),(0,s.jsx)(eb.Rx,{onClick:tr,className:"bg-destructive hover:bg-destructive/90",children:"Yes, delete form"})]})]})}),(0,s.jsx)(eb.Lt,{open:eZ,onOpenChange:eK,children:(0,s.jsxs)(eb.EO,{children:[(0,s.jsxs)(eb.wd,{children:[(0,s.jsx)(eb.r7,{children:"Cancel This Gift?"}),(0,s.jsxs)(eb.$v,{children:["This will attempt to cancel the gift for ",(0,s.jsx)("span",{className:"font-bold",children:eQ?.recipientName}),". This cannot be undone. If the gift has already been claimed, this will fail."]})]}),(0,s.jsxs)(eb.ck,{children:[(0,s.jsx)(eb.Zr,{onClick:()=>eJ(null),children:"Back"}),(0,s.jsx)(eb.Rx,{onClick:tu,className:"bg-destructive hover:bg-destructive/90",children:"Yes, cancel this gift"})]})]})})]})}},50499:(e,t,r)=>{Promise.resolve().then(r.bind(r,1132))},55511:e=>{"use strict";e.exports=require("crypto")},57207:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(82614).A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},61193:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>f});var s=r(60687);r(43210);var a=r(16189),n=r(68504),i=r(33870),l=r(76113),o=r(96556),d=r(29523),c=r(30474),u=r(85814),h=r.n(u);function f({children:e}){let{user:t,loading:r}=(0,n.A)();return((0,a.useRouter)(),r||!t?.isAdmin)?(0,s.jsx)("div",{className:"flex min-h-screen w-full flex-col items-center justify-center bg-background",children:(0,s.jsx)("p",{className:"text-muted-foreground",children:"Verifying admin credentials..."})}):(0,s.jsx)(i.GB,{children:(0,s.jsxs)("div",{className:"flex min-h-screen w-full",children:[(0,s.jsx)(l.z,{}),(0,s.jsxs)("div",{className:"flex flex-1 flex-col",children:[(0,s.jsxs)("header",{className:"sticky top-0 z-30 flex h-14 items-center gap-4 border-b bg-sidebar px-4 sm:h-auto sm:border-0 sm:bg-transparent sm:px-6 md:hidden",children:[(0,s.jsx)(i.x2,{asChild:!0,children:(0,s.jsxs)(d.$,{variant:"ghost",size:"icon",className:"text-sidebar-foreground hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",children:[(0,s.jsx)(o.A,{}),(0,s.jsx)("span",{className:"sr-only",children:"Toggle Menu"})]})}),(0,s.jsx)(h(),{href:"/user/dashboard",className:"flex items-center gap-2 text-lg font-semibold md:text-base font-headline text-sidebar-foreground",children:(0,s.jsx)(c.default,{src:"https://firebasestorage.googleapis.com/v0/b/openhouse-dashboard.firebasestorage.app/o/RMOHbug%20white.png?alt=media",alt:"RateMyOpenHouse.com Logo",width:150,height:40,className:"w-auto h-8","data-ai-hint":"app logo white"})})]}),(0,s.jsx)("main",{className:"flex-1 p-4 sm:p-6",children:e}),(0,s.jsx)("footer",{className:"py-4 px-6 mt-auto",children:(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsx)(c.default,{src:"https://firebasestorage.googleapis.com/v0/b/openhouse-dashboard.firebasestorage.app/o/RMOHbug.png?alt=media",alt:"RateMyOpenHouse.com Icon",width:40,height:40,className:"h-8 w-auto opacity-50","data-ai-hint":"app icon"})})})]})]})})}},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},63503:(e,t,r)=>{"use strict";r.d(t,{Cf:()=>h,Es:()=>m,L3:()=>x,c7:()=>f,lG:()=>o,rr:()=>p,zM:()=>d});var s=r(60687),a=r(43210),n=r(10991),i=r(78726),l=r(4780);let o=n.bL,d=n.l9,c=n.ZL;n.bm;let u=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)(n.hJ,{ref:r,className:(0,l.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));u.displayName=n.hJ.displayName;let h=a.forwardRef(({className:e,children:t,...r},a)=>(0,s.jsxs)(c,{children:[(0,s.jsx)(u,{}),(0,s.jsxs)(n.UC,{ref:a,className:(0,l.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...r,children:[t,(0,s.jsxs)(n.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(i.A,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]}));h.displayName=n.UC.displayName;let f=({className:e,...t})=>(0,s.jsx)("div",{className:(0,l.cn)("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});f.displayName="DialogHeader";let m=({className:e,...t})=>(0,s.jsx)("div",{className:(0,l.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});m.displayName="DialogFooter";let x=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)(n.hE,{ref:r,className:(0,l.cn)("text-lg font-semibold leading-none tracking-tight",e),...t}));x.displayName=n.hE.displayName;let p=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)(n.VY,{ref:r,className:(0,l.cn)("text-sm text-muted-foreground",e),...t}));p.displayName=n.VY.displayName},64571:(e,t,r)=>{Promise.resolve().then(r.bind(r,44412))},65456:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(82614).A)("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]])},68514:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>h,tree:()=>d});var s=r(65239),a=r(48088),n=r(88170),i=r.n(n),l=r(30893),o={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);r.d(t,o);let d={children:["",{children:["admin",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,1132)),"/home/user/studio/src/app/admin/page.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,99111)),"/home/user/studio/src/app/admin/layout.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,61137)),"/home/user/studio/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["/home/user/studio/src/app/admin/page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},h=new s.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/admin/page",pathname:"/admin",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},69795:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(82614).A)("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]])},73496:e=>{"use strict";e.exports=require("http2")},74075:e=>{"use strict";e.exports=require("zlib")},74112:(e,t,r)=>{"use strict";r.d(t,{A:()=>d});var s=r(55511),a=r.n(s);let n={randomUUID:a().randomUUID},i=new Uint8Array(256),l=i.length,o=[];for(let e=0;e<256;++e)o.push((e+256).toString(16).slice(1));let d=function(e,t,r){if(n.randomUUID&&!t&&!e)return n.randomUUID();let s=(e=e||{}).random||(e.rng||function(){return l>i.length-16&&(a().randomFillSync(i),l=0),i.slice(l,l+=16)})();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,t){r=r||0;for(let e=0;e<16;++e)t[r+e]=s[e];return t}return function(e,t=0){return o[e[t+0]]+o[e[t+1]]+o[e[t+2]]+o[e[t+3]]+"-"+o[e[t+4]]+o[e[t+5]]+"-"+o[e[t+6]]+o[e[t+7]]+"-"+o[e[t+8]]+o[e[t+9]]+"-"+o[e[t+10]]+o[e[t+11]]+o[e[t+12]]+o[e[t+13]]+o[e[t+14]]+o[e[t+15]]}(s)}},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},90357:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(82614).A)("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]])},91645:e=>{"use strict";e.exports=require("net")},92477:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(82614).A)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]])},92964:(e,t,r)=>{Promise.resolve().then(r.bind(r,99111))},94735:e=>{"use strict";e.exports=require("events")},96834:(e,t,r)=>{"use strict";r.d(t,{E:()=>l});var s=r(60687);r(43210);var a=r(24224),n=r(4780);let i=(0,a.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l({className:e,variant:t,...r}){return(0,s.jsx)("div",{className:(0,n.cn)(i({variant:t}),e),...r})}},99111:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/user/studio/src/app/admin/layout.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/user/studio/src/app/admin/layout.tsx","default")}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[447,724,16,306,814,520,377,840,300,895,627,999,244,470],()=>r(68514));module.exports=s})();