(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3698],{1394:(e,s,l)=>{"use strict";l.d(s,{BK:()=>d,eu:()=>i,q5:()=>c});var t=l(5155),a=l(2115),r=l(5977),n=l(9434);let i=a.forwardRef((e,s)=>{let{className:l,...a}=e;return(0,t.jsx)(r.bL,{ref:s,className:(0,n.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",l),...a})});i.displayName=r.bL.displayName;let d=a.forwardRef((e,s)=>{let{className:l,...a}=e;return(0,t.jsx)(r._V,{ref:s,className:(0,n.cn)("aspect-square h-full w-full object-cover",l),...a})});d.displayName=r._V.displayName;let c=a.forwardRef((e,s)=>{let{className:l,...a}=e;return(0,t.jsx)(r.H4,{ref:s,className:(0,n.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",l),...a})});c.displayName=r.H4.displayName},2525:(e,s,l)=>{"use strict";l.r(s),l.d(s,{default:()=>em});var t=l(5155),a=l(2115),r=l(5317),n=l(8214),i=l(6695),d=l(5127),c=l(704),o=l(9434);let h=c.bL,x=a.forwardRef((e,s)=>{let{className:l,...a}=e;return(0,t.jsx)(c.B8,{ref:s,className:(0,o.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",l),...a})});x.displayName=c.B8.displayName;let u=a.forwardRef((e,s)=>{let{className:l,...a}=e;return(0,t.jsx)(c.l9,{ref:s,className:(0,o.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",l),...a})});u.displayName=c.l9.displayName;let m=a.forwardRef((e,s)=>{let{className:l,...a}=e;return(0,t.jsx)(c.UC,{ref:s,className:(0,o.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",l),...a})});m.displayName=c.UC.displayName;var j=l(1394),f=l(7481),p=l(2523),g=l(6766),v=l(6874),b=l.n(v),N=l(6126),w=l(286),y=l(8186),A=l(2160),C=l(9591),S=l(1721),k=l(8390),L=l(1920),B=l(7648),R=l(172),E=l(3561),F=l(5599),U=l(6603),D=l(4301),G=l(8763),M=l(7223),q=l(203),H=l(3926),I=l(285),O=l(4165),T=l(2177),Z=l(221),_=l(5594),z=l(7759),$=l(8539),V=l(9409),Y=l(9737),Q=l(2346),W=l(4838),P=l(10),J=l(4477);let K=(0,J.createServerReference)("00fcf9e9e6af0f45e38921aaa0add6f733eb9b9555",J.callServer,void 0,J.findSourceMapURL,"getAdminDashboardData"),X=(0,J.createServerReference)("0060f2626fae36a5d8bd07ebfd3f4740f8f087f2cd",J.callServer,void 0,J.findSourceMapURL,"getAvailableGiftbitRegionsAndBrands"),ee=(0,J.createServerReference)("006a0aecd529551c1ed2d9b93f7e44949be03e83f1",J.callServer,void 0,J.findSourceMapURL,"getAdminGiftData"),es=(0,J.createServerReference)("006240ef5553d2ad3789ed54966942dcb024bb4a28",J.callServer,void 0,J.findSourceMapURL,"getGiftbitBalance"),el=(0,J.createServerReference)("407bb6f56c7e5a4a370639c232be633c1d88a6eb1f",J.callServer,void 0,J.findSourceMapURL,"saveGiftbitSettings"),et=(0,J.createServerReference)("40089f17ceaf65bc4808670c49344e3908c1f60283",J.callServer,void 0,J.findSourceMapURL,"cancelGiftbitReward");var ea=l(7426),er=l(498),en=l(4884);let ei=a.forwardRef((e,s)=>{let{className:l,...a}=e;return(0,t.jsx)(en.bL,{className:(0,o.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",l),...a,ref:s,children:(0,t.jsx)(en.zi,{className:(0,o.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});ei.displayName=en.bL.displayName;var ed=l(7655);let ec=a.forwardRef((e,s)=>{let{className:l,children:a,...r}=e;return(0,t.jsxs)(ed.bL,{ref:s,className:(0,o.cn)("relative overflow-hidden",l),...r,children:[(0,t.jsx)(ed.LM,{className:"h-full w-full rounded-[inherit]",children:a}),(0,t.jsx)(eo,{}),(0,t.jsx)(ed.OK,{})]})});ec.displayName=ed.bL.displayName;let eo=a.forwardRef((e,s)=>{let{className:l,orientation:a="vertical",...r}=e;return(0,t.jsx)(ed.VM,{ref:s,orientation:a,className:(0,o.cn)("flex touch-none select-none transition-colors","vertical"===a&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===a&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",l),...r,children:(0,t.jsx)(ed.lr,{className:"relative flex-1 rounded-full bg-border"})})});eo.displayName=ed.VM.displayName;let eh=_.Ik({id:_.Yj(),value:_.Yj().min(1,"Option text cannot be empty")}),ex=_.Ik({id:_.Yj(),text:_.Yj().min(3,"Question text must be at least 3 characters"),type:_.k5(["short-answer","yes-no","rating","multiple-choice"]),options:_.YO(eh).optional()}),eu=_.Ik({title:_.Yj().min(3,"Title must be at least 3 characters"),questions:_.YO(ex).min(1,"You must add at least one question")});function em(){var e;let[s,l]=(0,a.useState)({totalUsers:0,newUsers7Days:0,totalOpenHouses:0,newOpenHouses7Days:0,totalGifts:0,newGifts7Days:0}),[c,o]=(0,a.useState)([]),[v,_]=(0,a.useState)([]),[J,en]=(0,a.useState)([]),[ed,eo]=(0,a.useState)([]),[eh,ex]=(0,a.useState)({}),[em,ej]=(0,a.useState)(null),[ef,ep]=(0,a.useState)(!0),{toast:eg}=(0,f.dj)(),[ev,eb]=(0,a.useState)(""),[eN,ew]=(0,a.useState)(""),[ey,eA]=(0,a.useState)(""),[eC,eS]=(0,a.useState)(!1),[ek,eL]=(0,a.useState)(null),[eB,eR]=(0,a.useState)(!1),[eE,eF]=(0,a.useState)(null),[eU,eD]=(0,a.useState)([]),[eG,eM]=(0,a.useState)([]),[eq,eH]=(0,a.useState)(!0),[eI,eO]=(0,a.useState)(!0),[eT,eZ]=(0,a.useState)([]),[e_,ez]=(0,a.useState)([]),[e$,eV]=(0,a.useState)(!1),[eY,eQ]=(0,a.useState)(!1),[eW,eP]=(0,a.useState)(null),eJ=e=>{if(!e)return"??";let s=e.split(" ");return s.length>1?(s[0][0]+s[s.length-1][0]).toUpperCase():e.substring(0,2).toUpperCase()},eK=(0,a.useCallback)(async()=>{ep(!0),eH(!0),eO(!0);try{var e,s;let{stats:t,users:a,openHouses:r,forms:n,settings:i}=await K();l(t),o(a),_(r),en(n),ex(i),eZ((null==(e=i.giftbit)?void 0:e.enabledRegionCodes)||[]),ez((null==(s=i.giftbit)?void 0:s.enabledBrandCodes)||[]);let{regions:d,brands:c}=await X();eD(d),eM(c),eH(!1);let h=await ee();eo(h),eO(!1);let x=await es();ej(x)}catch(e){console.error("Error fetching admin data:",e),eg({variant:"destructive",title:"Error",description:"Could not fetch admin data. You might not have the required permissions."})}ep(!1)},[eg]);(0,a.useEffect)(()=>{eK()},[eK]);let eX=(0,T.mN)({resolver:(0,Z.u)(eu),defaultValues:{title:"",questions:[]}}),{fields:e0,append:e4,remove:e2,update:e1,move:e5}=(0,T.jz)({control:eX.control,name:"questions"});(0,a.useEffect)(()=>{ek?eX.reset({title:ek.title,questions:ek.questions.map(e=>({...e}))}):eX.reset({title:"",questions:[]})},[ek,eX]);let e6=eX.watch("questions"),e3=e=>{let s=eX.getValues("questions.".concat(e)),l=[...s.options||[],{id:(0,Y.A)(),value:""}];e1(e,{...s,options:l})},e7=(e,s)=>{var l;let t=eX.getValues("questions.".concat(e)),a=null==(l=t.options)?void 0:l.filter((e,l)=>l!==s);e1(e,{...t,options:a})};async function e8(e){try{if(ek){let s=(0,r.H9)(n.db,"feedbackForms",ek.id);await (0,r.mZ)(s,{title:e.title,questions:e.questions})}else await (0,r.gS)((0,r.collection)(n.db,"feedbackForms"),{...e,type:"global",createdAt:r.Dc.now()});ss(),await eK()}catch(e){console.error("Error saving form:",e),eg({variant:"destructive",title:"Error",description:"Could not save the form."})}}let e9=async()=>{if(eE)try{await (0,r.kd)((0,r.H9)(n.db,"feedbackForms",eE)),await eK()}catch(e){console.error("Error deleting form:",e),eg({variant:"destructive",title:"Delete Failed",description:"Could not delete the form."})}finally{eR(!1),eF(null)}},se=e=>{eL(e||null),eS(!0)},ss=()=>{eS(!1),eL(null),eX.reset()},sl=e=>{eF(e),eR(!0)},st=e=>{eP(e),eQ(!0)},sa=async e=>{try{let s=(0,r.H9)(n.db,"settings","appDefaults");await (0,r.BN)(s,{defaultGlobalFormId:e},{merge:!0}),ex(s=>({...s,defaultGlobalFormId:e})),eg({title:"Default Form Set",description:"New users will now receive this form by default."})}catch(e){console.error("Error setting default form:",e),eg({variant:"destructive",title:"Error",description:"Could not set the default form."})}},sr=(e,s)=>{eZ(l=>s?[...l,e]:l.filter(s=>s!==e))},sn=(e,s)=>{ez(l=>s?[...l,e]:l.filter(s=>s!==e))},si=async()=>{eV(!0);let e=await el({enabledRegionCodes:eT,enabledBrandCodes:e_});e.success?eg({title:"Giftbit settings saved successfully!"}):eg({variant:"destructive",title:"Error",description:e.message}),eV(!1)},sd=async()=>{if(!eW)return;let e=await et(eW.id);e.success?(eg({title:"Success",description:e.message}),await eK()):eg({variant:"destructive",title:"Cancellation Failed",description:e.message}),eQ(!1),eP(null)},sc=(0,a.useMemo)(()=>c.filter(e=>{var s,l;return(null==(s=e.name)?void 0:s.toLowerCase().includes(ev.toLowerCase()))||(null==(l=e.email)?void 0:l.toLowerCase().includes(ev.toLowerCase()))}),[c,ev]),so=(0,a.useMemo)(()=>{let e=new Map(c.map(e=>[e.id,e]));return v.map(s=>{var l;return{...s,userName:(null==(l=e.get(s.userId))?void 0:l.name)||"Unknown User"}}).filter(e=>e.address.toLowerCase().includes(eN.toLowerCase())||e.userName.toLowerCase().includes(eN.toLowerCase()))},[v,eN,c]),sh=(0,a.useMemo)(()=>0===eT.length?[]:eG.filter(e=>e.region_codes.some(e=>eT.includes(e))).sort((e,s)=>e.name.localeCompare(s.name)),[eG,eT]),sx=(0,a.useMemo)(()=>ed.filter(e=>e.recipientName.toLowerCase().includes(ey.toLowerCase())||e.recipientEmail.toLowerCase().includes(ey.toLowerCase())||e.senderName.toLowerCase().includes(ey.toLowerCase())||e.senderEmail.toLowerCase().includes(ey.toLowerCase())||e.brandCode.toLowerCase().includes(ey.toLowerCase())),[ed,ey]),su=e=>"number"!=typeof e?"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e/100),sm=e=>{if(!e)return"N/A";let s="string"==typeof e?new Date(e):e.toDate();return(0,ea.GP)(s,"MMM d, yyyy")},sj=e=>{if(!e)return"N/A";let s="string"==typeof e?new Date(e):e.toDate();return(0,ea.GP)(s,"MMM d, yyyy p")},sf=e=>{if(!e)return"N/A";let s="string"==typeof e?new Date(e):e.toDate();return(0,er.m)(s,{addSuffix:!0})},sp=e=>{let{title:s,value:l,subtext:a,icon:r,isLoading:n}=e;return(0,t.jsxs)(i.Zp,{children:[(0,t.jsxs)(i.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,t.jsx)(i.ZB,{className:"text-sm font-medium",children:s}),r]}),(0,t.jsxs)(i.Wu,{children:[n?(0,t.jsx)("div",{className:"h-7 w-24 bg-muted animate-pulse rounded-md"}):(0,t.jsx)("div",{className:"text-2xl font-bold",children:l}),a&&(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:a})]})]})};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"w-full mx-auto space-y-8",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold tracking-tight font-headline",children:"Admin Dashboard"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:"Oversee users, forms, and platform settings."})]}),(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,t.jsx)(sp,{title:"Total Users",value:s.totalUsers,subtext:"".concat(s.newUsers7Days," new in last 7 days"),icon:(0,t.jsx)(w.A,{className:"h-4 w-4 text-muted-foreground"}),isLoading:ef}),(0,t.jsx)(sp,{title:"Total Open Houses",value:s.totalOpenHouses,subtext:"".concat(s.newOpenHouses7Days," new in last 7 days"),icon:(0,t.jsx)(y.A,{className:"h-4 w-4 text-muted-foreground"}),isLoading:ef}),(0,t.jsx)(sp,{title:"Total Gifts Sent",value:s.totalGifts,subtext:"".concat(s.newGifts7Days," in last 7 days"),icon:(0,t.jsx)(A.A,{className:"h-4 w-4 text-muted-foreground"}),isLoading:ef}),(0,t.jsx)(sp,{title:"Giftbit Balance",value:su(null!=em?em:void 0),icon:(0,t.jsx)(C.A,{className:"h-4 w-4 text-muted-foreground"}),isLoading:null===em})]}),(0,t.jsxs)(h,{defaultValue:"users",className:"w-full",children:[(0,t.jsxs)(x,{className:"grid w-full grid-cols-1 sm:grid-cols-2 md:grid-cols-5 h-auto md:h-10",children:[(0,t.jsx)(u,{value:"users",children:"All Users"}),(0,t.jsx)(u,{value:"openHouses",children:"Open Houses"}),(0,t.jsx)(u,{value:"allGifts",children:"All Gifts"}),(0,t.jsx)(u,{value:"formLibrary",children:"Form Library"}),(0,t.jsx)(u,{value:"giftBrands",children:"Gift Brands"})]}),(0,t.jsx)(m,{value:"users",children:(0,t.jsxs)(i.Zp,{children:[(0,t.jsx)(i.aR,{children:(0,t.jsxs)("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4",children:[(0,t.jsxs)("div",{className:"w-full",children:[(0,t.jsx)(i.ZB,{children:"All Users"}),(0,t.jsx)(i.BT,{children:"A list of all registered users on the platform."})]}),(0,t.jsx)(p.p,{placeholder:"Search by name or email...",value:ev,onChange:e=>eb(e.target.value),className:"w-full md:w-64"})]})}),(0,t.jsx)(i.Wu,{children:ef?(0,t.jsx)("p",{children:"Loading users..."}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"md:hidden space-y-4",children:sc.length>0?sc.map(e=>(0,t.jsxs)(i.Zp,{children:[(0,t.jsx)(i.aR,{children:(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsxs)(j.eu,{children:[(0,t.jsx)(j.BK,{src:e.photoURL||"",alt:e.name||"avatar","data-ai-hint":"person avatar"}),(0,t.jsx)(j.q5,{children:eJ(e.name)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(i.ZB,{className:"text-base",children:e.name}),(0,t.jsx)(i.BT,{children:e.email})]})]})}),(0,t.jsxs)(i.Wu,{className:"space-y-2 text-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsxs)("span",{className:"text-muted-foreground flex items-center gap-1",children:[(0,t.jsx)(S.A,{className:"w-4 h-4"})," Role:"]}),e.isAdmin?(0,t.jsx)(N.E,{children:"Admin"}):(0,t.jsx)(N.E,{variant:"secondary",children:"User"})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsxs)("span",{className:"text-muted-foreground flex items-center gap-1",children:[(0,t.jsx)(k.A,{className:"w-4 h-4"})," Balance:"]}),(0,t.jsx)("span",{className:"font-medium",children:su(e.availableBalance)})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsxs)("span",{className:"text-muted-foreground flex items-center gap-1",children:[(0,t.jsx)(L.A,{className:"w-4 h-4"})," User Since:"]}),(0,t.jsx)("span",{className:"font-medium",children:sm(e.createdAt)})]}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsxs)("span",{className:"text-muted-foreground flex items-center gap-1",children:[(0,t.jsx)(B.A,{className:"w-4 h-4"})," Last Activity:"]}),(0,t.jsx)("span",{className:"font-medium",children:sj(e.lastLoginAt)})]})]})]},e.id)):(0,t.jsx)("div",{className:"h-24 text-center flex items-center justify-center",children:(0,t.jsx)("p",{children:"No users found."})})}),(0,t.jsx)("div",{className:"border rounded-lg hidden md:block overflow-x-auto",children:(0,t.jsxs)(d.XI,{children:[(0,t.jsx)(d.A0,{children:(0,t.jsxs)(d.Hj,{children:[(0,t.jsx)(d.nd,{children:"User"}),(0,t.jsx)(d.nd,{children:"Email"}),(0,t.jsx)(d.nd,{children:"Role"}),(0,t.jsx)(d.nd,{children:"Balance"}),(0,t.jsx)(d.nd,{children:"User Since"}),(0,t.jsx)(d.nd,{children:"Last Activity"})]})}),(0,t.jsx)(d.BF,{children:sc.length>0?sc.map(e=>(0,t.jsxs)(d.Hj,{children:[(0,t.jsx)(d.nA,{children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)(j.eu,{children:[(0,t.jsx)(j.BK,{src:e.photoURL||"",alt:e.name||"avatar","data-ai-hint":"person avatar"}),(0,t.jsx)(j.q5,{children:eJ(e.name)})]}),(0,t.jsx)("div",{children:(0,t.jsx)("p",{className:"font-medium",children:e.name})})]})}),(0,t.jsx)(d.nA,{children:e.email}),(0,t.jsx)(d.nA,{children:e.isAdmin?(0,t.jsx)(N.E,{children:"Admin"}):(0,t.jsx)(N.E,{variant:"secondary",children:"User"})}),(0,t.jsx)(d.nA,{children:su(e.availableBalance)}),(0,t.jsx)(d.nA,{children:sm(e.createdAt)}),(0,t.jsx)(d.nA,{children:sj(e.lastLoginAt)})]},e.id)):(0,t.jsx)(d.Hj,{children:(0,t.jsx)(d.nA,{colSpan:6,className:"h-24 text-center",children:"No users found."})})})]})})]})})]})}),(0,t.jsx)(m,{value:"openHouses",children:(0,t.jsxs)(i.Zp,{children:[(0,t.jsx)(i.aR,{children:(0,t.jsxs)("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4",children:[(0,t.jsxs)("div",{className:"w-full",children:[(0,t.jsx)(i.ZB,{children:"All Open Houses"}),(0,t.jsx)(i.BT,{children:"A list of all open houses created by users."})]}),(0,t.jsx)(p.p,{placeholder:"Search by address or user...",value:eN,onChange:e=>ew(e.target.value),className:"w-full md:w-64"})]})}),(0,t.jsx)(i.Wu,{children:ef?(0,t.jsx)("p",{children:"Loading open houses..."}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"md:hidden space-y-4",children:so.length>0?so.map(e=>(0,t.jsxs)(i.Zp,{children:[(0,t.jsx)(i.aR,{children:(0,t.jsxs)("div",{className:"flex items-start gap-4",children:[(0,t.jsx)(b(),{href:"/user/open-house/".concat(e.id),children:(0,t.jsx)("div",{className:"w-24 h-16 relative rounded-md overflow-hidden border flex-shrink-0 bg-muted",children:e.imageUrl?(0,t.jsx)(g.default,{src:e.imageUrl,alt:"Image of ".concat(e.address),fill:!0,className:"object-cover","data-ai-hint":"house exterior"}):(0,t.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,t.jsx)(y.A,{className:"w-8 h-8 text-muted-foreground"})})})}),(0,t.jsxs)("div",{className:"flex-grow",children:[(0,t.jsx)(i.ZB,{className:"text-base leading-tight",children:(0,t.jsx)(b(),{href:"/user/open-house/".concat(e.id),className:"hover:underline",children:e.address})}),(0,t.jsx)(i.BT,{className:"mt-1",children:e.userName})]})]})}),(0,t.jsx)(i.wL,{children:e.isActive?(0,t.jsx)(N.E,{className:"bg-green-600 text-white hover:bg-green-600",children:"Active"}):(0,t.jsx)(N.E,{variant:"outline",children:"Inactive"})})]},e.id)):(0,t.jsx)("div",{className:"h-24 text-center flex items-center justify-center",children:(0,t.jsx)("p",{children:"No open houses found."})})}),(0,t.jsx)("div",{className:"border rounded-lg hidden md:block overflow-x-auto",children:(0,t.jsxs)(d.XI,{children:[(0,t.jsx)(d.A0,{children:(0,t.jsxs)(d.Hj,{children:[(0,t.jsx)(d.nd,{children:"Property"}),(0,t.jsx)(d.nd,{children:"Address"}),(0,t.jsx)(d.nd,{children:"Created By"}),(0,t.jsx)(d.nd,{children:"Status"})]})}),(0,t.jsx)(d.BF,{children:so.length>0?so.map(e=>(0,t.jsxs)(d.Hj,{children:[(0,t.jsx)(d.nA,{children:(0,t.jsx)(b(),{href:"/user/open-house/".concat(e.id),children:(0,t.jsx)("div",{className:"w-24 h-16 relative rounded-md overflow-hidden border flex-shrink-0 bg-muted",children:e.imageUrl?(0,t.jsx)(g.default,{src:e.imageUrl,alt:"Image of ".concat(e.address),fill:!0,className:"object-cover","data-ai-hint":"house exterior"}):(0,t.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,t.jsx)(y.A,{className:"w-8 h-8 text-muted-foreground"})})})})}),(0,t.jsx)(d.nA,{children:(0,t.jsx)(b(),{href:"/user/open-house/".concat(e.id),className:"hover:underline font-medium block max-w-xs truncate",children:e.address})}),(0,t.jsx)(d.nA,{children:e.userName}),(0,t.jsx)(d.nA,{children:e.isActive?(0,t.jsx)(N.E,{className:"bg-green-600 text-white hover:bg-green-600",children:"Active"}):(0,t.jsx)(N.E,{variant:"outline",children:"Inactive"})})]},e.id)):(0,t.jsx)(d.Hj,{children:(0,t.jsx)(d.nA,{colSpan:4,className:"h-24 text-center",children:"No open houses found."})})})]})})]})})]})}),(0,t.jsx)(m,{value:"allGifts",children:(0,t.jsxs)(i.Zp,{children:[(0,t.jsx)(i.aR,{children:(0,t.jsxs)("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4",children:[(0,t.jsxs)("div",{className:"w-full",children:[(0,t.jsx)(i.ZB,{children:"All Gifts"}),(0,t.jsx)(i.BT,{children:"A complete log of all gifts created by all users."})]}),(0,t.jsx)(p.p,{placeholder:"Search gifts...",value:ey,onChange:e=>eA(e.target.value),className:"w-full md:w-64"})]})}),(0,t.jsx)(i.Wu,{children:eI?(0,t.jsx)("div",{className:"flex justify-center items-center h-48",children:(0,t.jsx)(R.A,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):(0,t.jsx)("div",{className:"border rounded-lg overflow-x-auto",children:(0,t.jsxs)(d.XI,{children:[(0,t.jsx)(d.A0,{children:(0,t.jsxs)(d.Hj,{children:[(0,t.jsx)(d.nd,{children:"Recipient"}),(0,t.jsx)(d.nd,{children:"Amount"}),(0,t.jsx)(d.nd,{children:"Sender"}),(0,t.jsx)(d.nd,{children:"DB Status"}),(0,t.jsx)(d.nd,{children:"Giftbit Status"}),(0,t.jsx)(d.nd,{children:"Created"}),(0,t.jsx)(d.nd,{className:"text-right",children:"Actions"})]})}),(0,t.jsx)(d.BF,{children:sx.length>0?sx.map(e=>{let s=e.giftbitStatus&&!["REDEEMED","CANCELLED"].includes(e.giftbitStatus);return(0,t.jsxs)(d.Hj,{children:[(0,t.jsxs)(d.nA,{children:[(0,t.jsx)("div",{className:"font-medium",children:e.recipientName}),(0,t.jsx)("div",{className:"text-sm text-muted-foreground",children:e.recipientEmail})]}),(0,t.jsx)(d.nA,{children:su(e.amountInCents)}),(0,t.jsx)(d.nA,{children:e.senderName}),(0,t.jsx)(d.nA,{children:(0,t.jsx)(N.E,{variant:"Sent"===e.status?"default":"Failed"===e.status?"destructive":"Cancelled"===e.status?"outline":"secondary",children:e.status})}),(0,t.jsx)(d.nA,{children:e.giftbitStatus?(0,t.jsx)(N.E,{variant:"outline",children:e.giftbitStatus.replace(/_/g," ")}):(0,t.jsx)("span",{className:"text-muted-foreground text-xs",children:"N/A"})}),(0,t.jsx)(d.nA,{title:sj(e.createdAt),children:sf(e.createdAt)}),(0,t.jsx)(d.nA,{className:"text-right",children:(0,t.jsxs)(W.rI,{children:[(0,t.jsx)(W.ty,{asChild:!0,children:(0,t.jsxs)(I.$,{variant:"ghost",size:"icon",children:[(0,t.jsx)(E.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Gift Actions"})]})}),(0,t.jsxs)(W.SQ,{align:"end",children:[e.claimUrl&&(0,t.jsxs)(W._2,{onClick:()=>navigator.clipboard.writeText(e.claimUrl||""),children:[(0,t.jsx)(F.A,{className:"mr-2 h-4 w-4"}),(0,t.jsx)("span",{children:"Copy Claim Link"})]}),s&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(W.mB,{}),(0,t.jsxs)(W._2,{onClick:()=>st(e),className:"text-destructive focus:text-destructive",children:[(0,t.jsx)(U.A,{className:"mr-2 h-4 w-4"}),(0,t.jsx)("span",{children:"Cancel Gift"})]})]})]})]})})]},e.id)}):(0,t.jsx)(d.Hj,{children:(0,t.jsx)(d.nA,{colSpan:7,className:"h-24 text-center",children:"No gifts found."})})})]})})})]})}),(0,t.jsx)(m,{value:"formLibrary",children:(0,t.jsxs)(i.Zp,{children:[(0,t.jsxs)(i.aR,{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[(0,t.jsxs)("div",{className:"w-full",children:[(0,t.jsx)(i.ZB,{children:"Form Library"}),(0,t.jsx)(i.BT,{children:"Manage feedback forms in the library that all users can access."})]}),(0,t.jsxs)(I.$,{onClick:()=>se(),className:"w-full sm:w-auto",children:[(0,t.jsx)(D.A,{className:"mr-2"})," Create New Form"]})]}),(0,t.jsx)(i.Wu,{children:ef?(0,t.jsx)("p",{children:"Loading forms..."}):J.length>0?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"mb-6 bg-muted/50 p-4 rounded-lg",children:[(0,t.jsx)("label",{className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",htmlFor:"default-form-select",children:"Default Form for New Users"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:"This form will be the default for all new users upon sign-up."}),(0,t.jsxs)(V.l6,{onValueChange:sa,value:eh.defaultGlobalFormId,children:[(0,t.jsx)(V.bq,{id:"default-form-select",className:"w-full max-w-sm",children:(0,t.jsx)(V.yv,{placeholder:"Select a default form..."})}),(0,t.jsx)(V.gC,{children:J.map(e=>(0,t.jsx)(V.eb,{value:e.id,children:e.title},e.id))})]})]}),(0,t.jsx)("div",{className:"border rounded-lg overflow-x-auto",children:(0,t.jsxs)(d.XI,{children:[(0,t.jsx)(d.A0,{children:(0,t.jsxs)(d.Hj,{children:[(0,t.jsx)(d.nd,{children:"Title"}),(0,t.jsx)(d.nd,{children:"Questions"}),(0,t.jsx)(d.nd,{className:"w-[100px] text-right",children:"Actions"})]})}),(0,t.jsx)(d.BF,{children:J.map(e=>(0,t.jsxs)(d.Hj,{children:[(0,t.jsxs)(d.nA,{className:"font-medium flex items-center gap-2",children:[e.title,e.id===eh.defaultGlobalFormId&&(0,t.jsx)(N.E,{variant:"secondary",children:"Default"})]}),(0,t.jsx)(d.nA,{children:e.questions.length}),(0,t.jsx)(d.nA,{className:"text-right",children:(0,t.jsxs)(W.rI,{children:[(0,t.jsx)(W.ty,{asChild:!0,children:(0,t.jsxs)(I.$,{variant:"ghost",size:"icon",children:[(0,t.jsx)(E.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Form Actions"})]})}),(0,t.jsxs)(W.SQ,{align:"end",children:[(0,t.jsxs)(W._2,{onClick:()=>se(e),children:[(0,t.jsx)(G.A,{className:"mr-2 h-4 w-4"}),(0,t.jsx)("span",{children:"Edit"})]}),(0,t.jsxs)(W._2,{onClick:()=>sl(e.id),className:"text-destructive focus:text-destructive",children:[(0,t.jsx)(M.A,{className:"mr-2 h-4 w-4"}),(0,t.jsx)("span",{children:"Delete"})]})]})]})})]},e.id))})]})})]}):(0,t.jsxs)("div",{className:"text-center py-16 border-2 border-dashed rounded-lg",children:[(0,t.jsx)("h3",{className:"text-xl font-medium",children:"No Forms in Library"}),(0,t.jsx)("p",{className:"text-muted-foreground mt-2",children:'Click "Create New Form" to build a new form for the library.'})]})})]})}),(0,t.jsx)(m,{value:"giftBrands",children:(0,t.jsxs)(i.Zp,{children:[(0,t.jsx)(i.aR,{children:(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(i.ZB,{children:"Gift Brands"}),(0,t.jsx)(i.BT,{children:"Configure which gift card regions and brands are available to users."})]}),(0,t.jsxs)(I.$,{onClick:si,disabled:e$,className:"w-full sm:w-auto",children:[e$&&(0,t.jsx)(R.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Save Changes"]})]})}),(0,t.jsx)(i.Wu,{children:eq?(0,t.jsx)("div",{className:"flex justify-center items-center h-48",children:(0,t.jsx)(R.A,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 items-start",children:[(0,t.jsxs)("div",{className:"md:col-span-1 space-y-4",children:[(0,t.jsx)("h3",{className:"text-lg font-medium",children:"Enabled Regions"}),(0,t.jsx)("div",{className:"space-y-3",children:eU.map(e=>(0,t.jsxs)("div",{className:"flex items-center space-x-2 p-3 rounded-md hover:bg-muted/50",children:[(0,t.jsx)(ei,{id:"region-".concat(e.code),checked:eT.includes(e.code),onCheckedChange:s=>sr(e.code,s)}),(0,t.jsxs)("label",{htmlFor:"region-".concat(e.code),className:"text-sm font-medium leading-none flex-grow cursor-pointer",children:[e.name," (",e.currency,")"]})]},e.code))})]}),(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("h3",{className:"text-lg font-medium mb-4",children:"Enabled Brands"}),(0,t.jsxs)(ec,{className:"h-[500px] border rounded-lg p-4",children:[(0,t.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:sh.map(e=>(0,t.jsxs)("div",{className:"flex items-start space-x-3 p-3 rounded-md hover:bg-muted/50",children:[(0,t.jsx)(ei,{id:"brand-".concat(e.brand_code),checked:e_.includes(e.brand_code),onCheckedChange:s=>sn(e.brand_code,s),className:"mt-1"}),(0,t.jsxs)("label",{htmlFor:"brand-".concat(e.brand_code),className:"flex flex-col gap-2 cursor-pointer",children:[(0,t.jsx)("div",{className:"w-20 h-10 relative bg-white rounded border flex items-center justify-center",children:(0,t.jsx)(g.default,{src:e.image_url,alt:e.name,fill:!0,className:"object-contain p-1","data-ai-hint":"company logo"})}),(0,t.jsx)("span",{className:"text-sm font-medium leading-none",children:e.name})]})]},e.brand_code))}),0===eT.length&&(0,t.jsx)("div",{className:"text-center py-10 text-muted-foreground",children:(0,t.jsx)("p",{children:"Select a region on the left to see available brands."})}),eT.length>0&&0===sh.length&&(0,t.jsx)("div",{className:"text-center py-10 text-muted-foreground",children:(0,t.jsx)("p",{children:"No brands available for the selected region(s)."})})]})]})]})})]})})]})]}),(0,t.jsx)(O.lG,{open:eC,onOpenChange:e=>!e&&ss(),children:(0,t.jsxs)(O.Cf,{className:"max-w-3xl",children:[(0,t.jsxs)(O.c7,{children:[(0,t.jsx)(O.L3,{children:ek?"Edit Form":"Create New Library Form"}),(0,t.jsx)(O.rr,{children:ek?"Modify the details of this form.":"Design a new feedback form for the library."})]}),(0,t.jsx)(z.lV,{...eX,children:(0,t.jsxs)("form",{onSubmit:eX.handleSubmit(e8),children:[(0,t.jsxs)("div",{className:"space-y-6 p-1 max-h-[60vh] overflow-y-auto",children:[(0,t.jsx)(z.zB,{control:eX.control,name:"title",render:e=>{let{field:s}=e;return(0,t.jsxs)(z.eI,{children:[(0,t.jsx)(z.lR,{children:"Form Title"}),(0,t.jsx)(z.MJ,{children:(0,t.jsx)(p.p,{placeholder:"e.g., General Property Feedback",...s})}),(0,t.jsx)(z.C5,{})]})}}),(0,t.jsx)(Q.w,{}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"flex justify-between items-center mb-4",children:(0,t.jsx)("h3",{className:"text-lg font-medium",children:"Questions"})}),(0,t.jsx)("div",{className:"space-y-4",children:e0.map((e,s)=>{var l,a;return(0,t.jsx)(i.Zp,{className:"p-4 bg-blue-50 dark:bg-blue-950/20 border-blue-200 dark:border-blue-900/50 relative transition-all",children:(0,t.jsxs)("div",{className:"flex justify-between items-start gap-4",children:[(0,t.jsxs)("div",{className:"flex-grow space-y-4",children:[(0,t.jsx)(z.zB,{control:eX.control,name:"questions.".concat(s,".text"),render:e=>{let{field:l}=e;return(0,t.jsxs)(z.eI,{children:[(0,t.jsxs)(z.lR,{children:["Question ",s+1]}),(0,t.jsx)(z.MJ,{children:(0,t.jsx)($.T,{placeholder:"What would you like to ask?",...l})}),(0,t.jsx)(z.C5,{})]})}}),(0,t.jsx)(z.zB,{control:eX.control,name:"questions.".concat(s,".type"),render:e=>{let{field:s}=e;return(0,t.jsxs)(z.eI,{children:[(0,t.jsx)(z.lR,{children:"Question Type"}),(0,t.jsxs)(V.l6,{onValueChange:s.onChange,defaultValue:s.value,children:[(0,t.jsx)(z.MJ,{children:(0,t.jsx)(V.bq,{children:(0,t.jsx)(V.yv,{placeholder:"Select a question type"})})}),(0,t.jsxs)(V.gC,{children:[(0,t.jsx)(V.eb,{value:"short-answer",children:"Short Answer"}),(0,t.jsx)(V.eb,{value:"yes-no",children:"Yes/No"}),(0,t.jsx)(V.eb,{value:"rating",children:"1-5 Rating"}),(0,t.jsx)(V.eb,{value:"multiple-choice",children:"Multiple Choice"})]})]}),(0,t.jsx)(z.C5,{})]})}}),(null==(l=e6[s])?void 0:l.type)==="multiple-choice"&&(0,t.jsxs)("div",{className:"space-y-3 pl-4 border-l-2 ml-2",children:[(0,t.jsx)(z.lR,{children:"Options"}),null==(a=e6[s].options)?void 0:a.map((e,l)=>(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(z.zB,{control:eX.control,name:"questions.".concat(s,".options.").concat(l,".value"),render:e=>{let{field:s}=e;return(0,t.jsxs)(z.eI,{className:"flex-grow",children:[(0,t.jsx)(z.MJ,{children:(0,t.jsx)(p.p,{placeholder:"Option ".concat(l+1),...s})}),(0,t.jsx)(z.C5,{})]})}}),(0,t.jsx)(I.$,{variant:"ghost",size:"icon",onClick:()=>e7(s,l),type:"button",children:(0,t.jsx)(M.A,{className:"w-4 h-4 text-destructive"})})]},e.id)),(0,t.jsxs)(I.$,{size:"sm",variant:"outline",type:"button",onClick:()=>e3(s),children:[(0,t.jsx)(D.A,{className:"mr-2"})," Add Option"]})]})]}),(0,t.jsxs)("div",{className:"absolute top-2 right-2 flex flex-col gap-1",children:[(0,t.jsx)(I.$,{variant:"ghost",size:"icon",onClick:()=>e5(s,s-1),disabled:0===s,type:"button","aria-label":"Move up",children:(0,t.jsx)(q.A,{className:"w-4 h-4"})}),(0,t.jsx)(I.$,{variant:"ghost",size:"icon",onClick:()=>e5(s,s+1),disabled:s===e0.length-1,type:"button","aria-label":"Move down",children:(0,t.jsx)(H.A,{className:"w-4 h-4"})}),(0,t.jsx)(I.$,{variant:"ghost",size:"icon",onClick:()=>e2(s),type:"button","aria-label":"Delete question",className:"text-destructive hover:text-destructive",children:(0,t.jsx)(M.A,{className:"w-4 h-4"})})]})]})},e.id)})}),(0,t.jsx)(z.C5,{children:null==(e=eX.formState.errors.questions)?void 0:e.message}),(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsxs)(I.$,{size:"sm",variant:"secondary",onClick:()=>{e4({id:(0,Y.A)(),text:"",type:"short-answer",options:[]})},type:"button",children:[(0,t.jsx)(D.A,{className:"mr-2"})," Add Question"]})})]})]}),(0,t.jsxs)(O.Es,{className:"mt-6 pt-4 border-t",children:[(0,t.jsx)(I.$,{type:"button",variant:"ghost",onClick:ss,children:"Cancel"}),(0,t.jsx)(I.$,{type:"submit",disabled:eX.formState.isSubmitting,children:eX.formState.isSubmitting?"Saving...":"Save Form"})]})]})})]})}),(0,t.jsx)(P.Lt,{open:eB,onOpenChange:eR,children:(0,t.jsxs)(P.EO,{children:[(0,t.jsxs)(P.wd,{children:[(0,t.jsx)(P.r7,{children:"Are you sure?"}),(0,t.jsx)(P.$v,{children:"This action cannot be undone. This will permanently delete this form from the library."})]}),(0,t.jsxs)(P.ck,{children:[(0,t.jsx)(P.Zr,{onClick:()=>eF(null),children:"Cancel"}),(0,t.jsx)(P.Rx,{onClick:e9,className:"bg-destructive hover:bg-destructive/90",children:"Yes, delete form"})]})]})}),(0,t.jsx)(P.Lt,{open:eY,onOpenChange:eQ,children:(0,t.jsxs)(P.EO,{children:[(0,t.jsxs)(P.wd,{children:[(0,t.jsx)(P.r7,{children:"Cancel This Gift?"}),(0,t.jsxs)(P.$v,{children:["This will attempt to cancel the gift for ",(0,t.jsx)("span",{className:"font-bold",children:null==eW?void 0:eW.recipientName}),". This cannot be undone. If the gift has already been claimed, this will fail."]})]}),(0,t.jsxs)(P.ck,{children:[(0,t.jsx)(P.Zr,{onClick:()=>eP(null),children:"Back"}),(0,t.jsx)(P.Rx,{onClick:sd,className:"bg-destructive hover:bg-destructive/90",children:"Yes, cancel this gift"})]})]})})]})}},5573:(e,s,l)=>{Promise.resolve().then(l.bind(l,2525))}},e=>{var s=s=>e(e.s=s);e.O(0,[2992,3644,1686,9035,2488,6874,1808,3063,5821,4434,6914,7426,3247,518,4016,1477,8441,1684,7358],()=>s(5573)),_N_E=e.O()}]);