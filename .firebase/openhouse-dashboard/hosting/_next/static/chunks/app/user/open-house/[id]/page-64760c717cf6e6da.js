(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[594],{172:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(157).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},295:(e,t,s)=>{"use strict";s.d(t,{f:()=>r});var a=s(4477);let r=(0,a.createServerReference)("002a7ac215804b5b9787d8ab7a455cdcccc8da7d92",a.callServer,void 0,a.findSourceMapURL,"listBrands")},2346:(e,t,s)=>{"use strict";s.d(t,{w:()=>i});var a=s(5155),r=s(2115),n=s(7489),l=s(9434);let i=r.forwardRef((e,t)=>{let{className:s,orientation:r="horizontal",decorative:i=!0,...o}=e;return(0,a.jsx)(n.b,{ref:t,decorative:i,orientation:r,className:(0,l.cn)("shrink-0 bg-border","horizontal"===r?"h-[1px] w-full":"h-full w-[1px]",s),...o})});i.displayName=n.b.displayName},2543:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(157).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},4063:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(157).A)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},4165:(e,t,s)=>{"use strict";s.d(t,{Cf:()=>m,Es:()=>x,L3:()=>f,c7:()=>h,lG:()=>o,rr:()=>p,zM:()=>d});var a=s(5155),r=s(2115),n=s(5821),l=s(5318),i=s(9434);let o=n.bL,d=n.l9,c=n.ZL;n.bm;let u=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.hJ,{ref:t,className:(0,i.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...r})});u.displayName=n.hJ.displayName;let m=r.forwardRef((e,t)=>{let{className:s,children:r,...o}=e;return(0,a.jsxs)(c,{children:[(0,a.jsx)(u,{}),(0,a.jsxs)(n.UC,{ref:t,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...o,children:[r,(0,a.jsxs)(n.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(l.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});m.displayName=n.UC.displayName;let h=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...s})};h.displayName="DialogHeader";let x=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s})};x.displayName="DialogFooter";let f=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.hE,{ref:t,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",s),...r})});f.displayName=n.hE.displayName;let p=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.VY,{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",s),...r})});p.displayName=n.VY.displayName},4301:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(157).A)("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]])},4477:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var s in t)Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}(t,{callServer:function(){return a.callServer},createServerReference:function(){return n},findSourceMapURL:function(){return r.findSourceMapURL}});let a=s(3806),r=s(1818),n=s(4979).createServerReference},5318:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(157).A)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},6102:(e,t,s)=>{"use strict";s.d(t,{Bc:()=>i,ZI:()=>c,k$:()=>d,m_:()=>o});var a=s(5155),r=s(2115),n=s(8082),l=s(9434);let i=n.Kq,o=n.bL,d=n.l9,c=r.forwardRef((e,t)=>{let{className:s,sideOffset:r=4,...i}=e;return(0,a.jsx)(n.UC,{ref:t,sideOffset:r,className:(0,l.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...i})});c.displayName=n.UC.displayName},6126:(e,t,s)=>{"use strict";s.d(t,{E:()=>i});var a=s(5155);s(2115);var r=s(2085),n=s(9434);let l=(0,r.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:t,variant:s,...r}=e;return(0,a.jsx)("div",{className:(0,n.cn)(l({variant:s}),t),...r})}},7223:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(157).A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},7887:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>em});var a=s(5155),r=s(2115),n=s(5317),l=s(858),i=s(8214),o=s(8030),d=s(5695),c=s(6766),u=s(6874),m=s.n(u),h=s(2177),x=s(5594),f=s(221),p=s(9737),j=s(295),g=s(6695),b=s(285),v=s(7481),y=s(157);let w=(0,y.A)("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);var N=s(389),k=s(2543),C=s(8186),A=s(172);let S=(0,y.A)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);var R=s(7223),I=s(8763),E=s(286),U=s(4063),M=s(2160),z=s(9829),B=s(10),H=s(4165),Z=s(2346),D=s(6126),q=s(9409),L=s(9434),F=s(4301);function O(e){var t;let{forms:s,selectedFormId:n,onFormSelect:l,triggerClassName:i}=e,o=(0,d.useRouter)(),{globalForms:c,customForms:u}=(0,r.useMemo)(()=>{let e=[],t=[];return s.forEach(s=>{"global"===s.type?e.push(s):t.push(s)}),{globalForms:e,customForms:t}},[s]),m=null==(t=s.find(e=>e.id===n))?void 0:t.title;return(0,a.jsxs)(q.l6,{value:n||"",onValueChange:e=>{"create-new-form"===e?o.push("/user/feedback-forms"):l(e)},children:[(0,a.jsx)(q.bq,{className:(0,L.cn)("w-[280px]",i),children:(0,a.jsx)(q.yv,{placeholder:"Select a feedback form...",children:m||"Select a feedback form..."})}),(0,a.jsxs)(q.gC,{children:[c.length>0&&(0,a.jsxs)(q.s3,{children:[(0,a.jsx)(q.TR,{children:"Form Templates"}),c.map(e=>(0,a.jsx)(q.eb,{value:e.id,children:e.title},e.id))]}),c.length>0&&u.length>0&&(0,a.jsx)(q.mi,{}),u.length>0&&(0,a.jsxs)(q.s3,{children:[(0,a.jsx)(q.TR,{children:"My Custom Forms"}),u.map(e=>(0,a.jsx)(q.eb,{value:e.id,children:e.title},e.id))]}),(c.length>0||u.length>0)&&(0,a.jsx)(q.mi,{}),(0,a.jsx)(q.s3,{children:(0,a.jsx)(q.eb,{value:"create-new-form",className:"text-primary focus:text-primary",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(F.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Create Custom Form"})]})})}),0===s.length&&(0,a.jsx)("div",{className:"p-4 text-center text-sm text-muted-foreground",children:"No forms available."})]})]})}var P=s(5185),V=s(6101),T=s(6081),G=s(5845),J=s(5503),Y=s(1275),$=s(3540),_="Switch",[W,X]=(0,T.A)(_),[K,Q]=W(_),ee=r.forwardRef((e,t)=>{let{__scopeSwitch:s,name:n,checked:l,defaultChecked:i,required:o,disabled:d,value:c="on",onCheckedChange:u,form:m,...h}=e,[x,f]=r.useState(null),p=(0,V.s)(t,e=>f(e)),j=r.useRef(!1),g=!x||m||!!x.closest("form"),[b=!1,v]=(0,G.i)({prop:l,defaultProp:i,onChange:u});return(0,a.jsxs)(K,{scope:s,checked:b,disabled:d,children:[(0,a.jsx)($.sG.button,{type:"button",role:"switch","aria-checked":b,"aria-required":o,"data-state":er(b),"data-disabled":d?"":void 0,disabled:d,value:c,...h,ref:p,onClick:(0,P.m)(e.onClick,e=>{v(e=>!e),g&&(j.current=e.isPropagationStopped(),j.current||e.stopPropagation())})}),g&&(0,a.jsx)(ea,{control:x,bubbles:!j.current,name:n,value:c,checked:b,required:o,disabled:d,form:m,style:{transform:"translateX(-100%)"}})]})});ee.displayName=_;var et="SwitchThumb",es=r.forwardRef((e,t)=>{let{__scopeSwitch:s,...r}=e,n=Q(et,s);return(0,a.jsx)($.sG.span,{"data-state":er(n.checked),"data-disabled":n.disabled?"":void 0,...r,ref:t})});es.displayName=et;var ea=e=>{let{control:t,checked:s,bubbles:n=!0,...l}=e,i=r.useRef(null),o=(0,J.Z)(s),d=(0,Y.X)(t);return r.useEffect(()=>{let e=i.current,t=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(o!==s&&t){let a=new Event("click",{bubbles:n});t.call(e,s),e.dispatchEvent(a)}},[o,s,n]),(0,a.jsx)("input",{type:"checkbox","aria-hidden":!0,defaultChecked:s,...l,tabIndex:-1,ref:i,style:{...e.style,...d,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function er(e){return e?"checked":"unchecked"}let en=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(ee,{className:(0,L.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s),...r,ref:t,children:(0,a.jsx)(es,{className:(0,L.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});en.displayName=ee.displayName;var el=s(5057),ei=s(7759),eo=s(2523),ed=s(6102);let ec=x.Ik({brandCode:x.Yj().min(1,"Please select a brand."),amountSelection:x.Yj(),customAmount:x.ai().optional(),autoSend:x.zM(),selectedBrand:x.Ie().optional()}).refine(e=>{if(!e.selectedBrand||"custom"!==e.amountSelection)return!0;if(void 0===e.customAmount||null===e.customAmount||e.customAmount<=0||!e.selectedBrand.denominations||0===e.selectedBrand.denominations.length)return!1;let t=100*e.customAmount,s=e.selectedBrand.denominations[0].min,a=e.selectedBrand.denominations[0].max;return t>=s&&t<=a},{message:"Custom amount is not within the allowed range for this brand.",path:["customAmount"]}).refine(e=>"custom"!==e.amountSelection||void 0!==e.customAmount&&e.customAmount>0,{message:"A custom amount is required.",path:["customAmount"]}),eu=x.Ik({streetNumber:x.Yj().min(1,"Street number is required."),streetName:x.Yj().min(1,"Street name is required."),unitNumber:x.Yj().optional(),city:x.Yj().min(1,"City is required."),state:x.Yj().min(2,"State is required.").max(2,"Use 2-letter abbreviation."),zipCode:x.Yj().min(5,"Zip code must be 5 digits.").max(5,"Zip code must be 5 digits.")});function em(){var e,t;let{user:s,loading:u}=(0,o.A)(),x=(0,d.useRouter)(),y=(0,d.useParams)(),{toast:L}=(0,v.dj)(),[F,P]=(0,r.useState)(null),[V,T]=(0,r.useState)([]),[G,J]=(0,r.useState)([]),[Y,$]=(0,r.useState)(!0),[_,W]=(0,r.useState)(null),[X,K]=(0,r.useState)(!1),[Q,ee]=(0,r.useState)([]),[et,es]=(0,r.useState)([]),[ea,er]=(0,r.useState)(!0),[em,eh]=(0,r.useState)(!1),ex=(0,r.useRef)(null),[ef,ep]=(0,r.useState)(!1),[ej,eg]=(0,r.useState)(!1),[eb,ev]=(0,r.useState)(!1),ey=y.id,ew=(0,h.mN)({resolver:(0,f.u)(eu),defaultValues:{streetNumber:"",streetName:"",unitNumber:"",city:"",state:"",zipCode:""}}),eN=(0,h.mN)({resolver:(0,f.u)(ec)}),ek=eN.watch("amountSelection"),eC=eN.watch("brandCode");(0,r.useMemo)(()=>{var e;let t=null==F||null==(e=F.giftAutomation)?void 0:e.amountInCents;return void 0===t?"500":[500,1e3,1500].includes(t)?String(t):"custom"},[null==F||null==(e=F.giftAutomation)?void 0:e.amountInCents]),(0,r.useMemo)(()=>G.find(e=>e.brand_code===eC),[G,eC]);let eA=(0,r.useCallback)(async()=>{if(s&&ey){$(!0),er(!0),W(null);try{let l=(0,n.H9)(i.db,"openHouses",ey),o=await (0,n.x7)(l);if(o.exists()){let l={id:o.id,...o.data()};if(l.userId!==s.uid)W("You don't have permission to view this page."),P(null);else{var e,t,a,r;P(l);try{let e=await (0,j.f)();J(e)}catch(e){console.error("Could not fetch Giftbit brands:",e),J([])}eN.reset({brandCode:null==(e=l.giftAutomation)?void 0:e.brandCode,amountSelection:(null==(t=l.giftAutomation)?void 0:t.amountInCents)?String(l.giftAutomation.amountInCents):"500",customAmount:(null==(a=l.giftAutomation)?void 0:a.amountInCents)?l.giftAutomation.amountInCents/100:void 0,autoSend:(null==(r=l.giftAutomation)?void 0:r.autoSend)||!1});let o=(0,n.query)((0,n.collection)(i.db,"feedbackForms"),(0,n.where)("type","==","global")),d=(0,n.query)((0,n.collection)(i.db,"feedbackForms"),(0,n.where)("type","==","custom"),(0,n.where)("userId","==",s.uid)),[c,u]=await Promise.all([(0,n.getDocs)(o),(0,n.getDocs)(d)]),m=[...c.docs.map(e=>({id:e.id,...e.data()})),...u.docs.map(e=>({id:e.id,...e.data()}))];T(m);let h=(0,n.query)((0,n.collection)(i.db,"leads"),(0,n.where)("openHouseId","==",ey),(0,n.where)("userId","==",s.uid)),x=(0,n.query)((0,n.collection)(i.db,"feedbackSubmissions"),(0,n.where)("openHouseId","==",ey),(0,n.where)("userId","==",s.uid)),[f,p]=await Promise.all([(0,n.getDocs)(h),(0,n.getDocs)(x)]);ee(f.docs.map(e=>e.data())),es(p.docs.map(e=>e.data()))}}else W("Open house not found."),P(null)}catch(e){console.error("Error fetching document:",e),"permission-denied"===e.code?W("You do not have permission to view these records."):W("Failed to fetch open house details."),P(null)}finally{$(!1),er(!1)}}},[ey,s,eN]);(0,r.useEffect)(()=>{!u&&s&&eA()},[u,s,eA]),(0,r.useEffect)(()=>{if(null==F?void 0:F.structuredAddress)ew.reset(F.structuredAddress);else if(F){let e=F.address.split(",").map(e=>e.trim());if(e.length>=3){let t=e[0].split(" "),s=t.length>1?t[0]:"",a=t.length>1?t.slice(1).join(" "):e[0],r=e[1],n=e[2].split(" "),l=n[0],i=n[1]||"";ew.reset({streetNumber:s,streetName:a,city:r,state:l,zipCode:i,unitNumber:""})}}},[F,ew]);let eS=async(e,t)=>{let s=(0,n.H9)(i.db,"openHouses",e);try{await (0,n.mZ)(s,{feedbackFormId:t}),await eA()}catch(e){console.error("Error setting feedback form:",e)}},eR=async e=>{if(!s)return;let t=(0,n.wP)(i.db),a=(0,n.query)((0,n.collection)(i.db,"openHouses"),(0,n.where)("userId","==",s.uid),(0,n.where)("isActive","==",!0));(await (0,n.getDocs)(a)).forEach(s=>{s.id!==e&&t.update(s.ref,{isActive:!1})});let r=(0,n.H9)(i.db,"openHouses",e);t.update(r,{isActive:!0});try{await t.commit(),await eA()}catch(e){console.error("Error setting active open house:",e)}},eI=async()=>{if(s&&F){K(!0);try{if(F.imageUrl){let e=(0,l.KR)(i.IG,F.imageUrl);await (0,l.XR)(e).catch(e=>{if("storage/object-not-found"!==e.code)throw e})}await (0,n.kd)((0,n.H9)(i.db,"openHouses",F.id)),x.push("/user/dashboard")}catch(e){console.error("Error deleting open house:",e),K(!1)}}};async function eE(e){if(!s||!F)return;let{streetNumber:t,streetName:a,unitNumber:r,city:l,state:o,zipCode:d}=e,c="".concat(t," ").concat(a).concat(r?" #".concat(r):"",", ").concat(l,", ").concat(o.toUpperCase()," ").concat(d);try{let t=(0,n.H9)(i.db,"openHouses",F.id);await (0,n.mZ)(t,{address:c,structuredAddress:e}),eh(!1),await eA()}catch(e){console.error("Error updating address:",e)}}let eU=async e=>{if(!e.target.files||0===e.target.files.length||!s||!F)return;let t=e.target.files[0];if(t.size>5242880)return;ep(!0);let a=(0,l.KR)(i.IG,"open-house-images/".concat(s.uid,"/").concat(F.id,"/").concat((0,p.A)()));try{let e=await (0,l.D)(a,t),s=await (0,l.qk)(e.ref),r=(0,n.H9)(i.db,"openHouses",F.id);await (0,n.mZ)(r,{imageUrl:s}),P(e=>e?{...e,imageUrl:s}:null)}catch(e){console.error("Error uploading image:",e)}finally{ep(!1)}},eM=async()=>{if(F&&F.imageUrl)try{let e=(0,l.KR)(i.IG,F.imageUrl);await (0,l.XR)(e);let t=(0,n.H9)(i.db,"openHouses",F.id);await (0,n.mZ)(t,{imageUrl:null}),P(e=>e?{...e,imageUrl:void 0}:null)}catch(e){console.error("Error removing image:",e)}finally{eg(!1)}},ez=async e=>{if(!F)return;let t={...e,selectedBrand:G.find(t=>t.brand_code===e.brandCode)},s=ec.safeParse(t);if(!s.success)return void s.error.errors.forEach(e=>{let t=e.path[0];eN.setError(t,{type:"manual",message:e.message})});let a=(0,n.H9)(i.db,"openHouses",F.id),r=0;r="custom"===e.amountSelection?e.customAmount?100*e.customAmount:0:parseInt(e.amountSelection,10);try{let t={enabled:!0,autoSend:e.autoSend,brandCode:e.brandCode,amountInCents:r};await (0,n.mZ)(a,{giftAutomation:t}),await eA(),ev(!1),L({title:"Success",description:"Gift automation settings have been updated."})}catch(e){console.error("Error updating gift settings:",e),L({variant:"destructive",title:"Error",description:"Could not save gift automation settings."})}},eB=async e=>{if(!F)return;let t=(0,n.H9)(i.db,"openHouses",F.id);try{let i;if(e){var s,a,r,l;i={...F.giftAutomation,enabled:!0,brandCode:(null==(s=F.giftAutomation)?void 0:s.brandCode)||(null==(a=G[0])?void 0:a.brand_code),amountInCents:(null==(r=F.giftAutomation)?void 0:r.amountInCents)||500,autoSend:(null==(l=F.giftAutomation)?void 0:l.autoSend)||!1}}else i={...F.giftAutomation,enabled:!1};await (0,n.mZ)(t,{giftAutomation:i}),await eA()}catch(e){console.error("Error updating gift automation:",e)}};if(Y||u)return(0,a.jsx)("p",{className:"text-muted-foreground",children:"Loading details..."});if(_)return(0,a.jsx)("p",{className:"text-destructive",children:_});if(!F)return(0,a.jsx)("p",{className:"text-muted-foreground",children:"Open house not found or you do not have permission to view it."});let eH=F.address.split(","),eZ=eH[0],eD=eH.length>1?eH.slice(1).join(",").trim():"",eq=(null==(t=F.giftAutomation)?void 0:t.enabled)||!1,eL=()=>(0,a.jsxs)(g.Zp,{className:"flex flex-col h-full hover:bg-muted/50 transition-colors",children:[(0,a.jsx)(g.aR,{className:"flex-grow pb-2",children:(0,a.jsxs)("div",{className:"flex flex-row items-center justify-between space-y-0",children:[(0,a.jsx)(g.ZB,{className:"text-sm font-medium",children:"Status"}),(0,a.jsx)(w,{className:"h-4 w-4 text-muted-foreground"})]})}),(0,a.jsx)(g.Wu,{children:F.isActive?(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:"text-2xl font-bold",children:"Active"}),(0,a.jsxs)(D.E,{className:"bg-green-600 text-white hover:bg-green-600",children:[(0,a.jsx)(N.A,{className:"mr-1"})," Live"]})]}):(0,a.jsx)("div",{className:"text-2xl font-bold",children:"Inactive"})})]});return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(ed.Bc,{children:(0,a.jsxs)("div",{className:"w-full mx-auto space-y-8",children:[(0,a.jsx)("div",{children:(0,a.jsxs)(b.$,{variant:"ghost",onClick:()=>x.back(),className:"mb-4 -ml-4",children:[(0,a.jsx)(k.A,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Back to Dashboard"})]})}),(0,a.jsxs)("div",{className:"flex flex-col md:flex-row items-start gap-4 md:gap-6",children:[(0,a.jsxs)("div",{className:"w-full md:w-48 h-48 md:h-32 relative rounded-md overflow-hidden border flex-shrink-0 bg-muted group",children:[F.imageUrl?(0,a.jsx)(c.default,{src:F.imageUrl,alt:"Image of ".concat(F.address),fill:!0,className:"object-cover","data-ai-hint":"house exterior"}):(0,a.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,a.jsx)(C.A,{className:"w-12 h-12 text-muted-foreground"})}),(0,a.jsxs)("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center gap-2 rounded-md opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,a.jsx)("button",{onClick:()=>{var e;return null==(e=ex.current)?void 0:e.click()},disabled:ef,className:"p-2 rounded-full bg-black/50 text-white hover:bg-black/70 transition-colors","aria-label":"Upload image",children:ef?(0,a.jsx)(A.A,{className:"h-6 w-6 animate-spin"}):(0,a.jsx)(S,{className:"h-6 w-6"})}),F.imageUrl&&(0,a.jsx)("button",{onClick:()=>eg(!0),className:"p-2 rounded-full bg-destructive/80 text-white hover:bg-destructive transition-colors","aria-label":"Remove image",children:(0,a.jsx)(R.A,{className:"h-6 w-6"})})]}),(0,a.jsx)("input",{type:"file",ref:ex,onChange:eU,className:"hidden",accept:"image/png, image/jpeg, image/gif"})]}),(0,a.jsxs)("div",{className:"flex-grow pt-1 w-full",children:[(0,a.jsx)("div",{className:"flex flex-col sm:flex-row justify-between sm:items-start",children:(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h1",{className:"text-2xl md:text-3xl font-bold tracking-tight font-headline",children:eZ}),(0,a.jsx)(b.$,{variant:"ghost",size:"icon",onClick:()=>eh(!0),className:"flex-shrink-0",children:(0,a.jsx)(I.A,{className:"h-5 w-5 text-muted-foreground"})})]}),(0,a.jsx)("p",{className:"text-muted-foreground",children:eD})]})}),(0,a.jsxs)("p",{className:"text-sm text-muted-foreground mt-2",children:["Created on ",F.createdAt?new Date(F.createdAt.toDate()).toLocaleDateString():"N/A"]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 lg:grid-cols-3",children:[(0,a.jsx)(g.Zp,{asChild:!0,className:"hover:bg-muted/50 transition-colors h-full",children:(0,a.jsxs)(m(),{href:"/user/my-leads?house=".concat(F.id),children:[(0,a.jsxs)(g.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(g.ZB,{className:"text-sm font-medium",children:"Total Leads"}),(0,a.jsx)(E.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsx)(g.Wu,{children:(0,a.jsx)("div",{className:"text-2xl font-bold",children:ea?"...":Q.length})})]})}),(0,a.jsx)(g.Zp,{asChild:!0,className:"hover:bg-muted/50 transition-colors h-full",children:(0,a.jsxs)(m(),{href:"/user/open-house/".concat(F.id,"/feedback"),children:[(0,a.jsxs)(g.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(g.ZB,{className:"text-sm font-medium",children:"Feedback Responses"}),(0,a.jsx)(U.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,a.jsx)(g.Wu,{children:(0,a.jsx)("div",{className:"text-2xl font-bold",children:ea?"...":et.length})})]})}),(0,a.jsx)("div",{className:"col-span-2 lg:col-span-1",children:F.isActive?(0,a.jsx)(eL,{}):(0,a.jsxs)(B.Lt,{children:[(0,a.jsx)(B.tv,{asChild:!0,children:(0,a.jsx)("button",{className:"w-full h-full text-left",children:(0,a.jsx)(eL,{})})}),(0,a.jsxs)(B.EO,{children:[(0,a.jsxs)(B.wd,{children:[(0,a.jsx)(B.r7,{children:"Make Open House Active?"}),(0,a.jsx)(B.$v,{children:"This will make your QR code direct visitors to this property's feedback form. Any other active open house will be deactivated."})]}),(0,a.jsxs)(B.ck,{children:[(0,a.jsx)(B.Zr,{children:"Cancel"}),(0,a.jsx)(B.Rx,{onClick:()=>eR(F.id),children:"Yes, make active"})]})]})]})})]}),(0,a.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,a.jsxs)(g.Zp,{children:[(0,a.jsxs)(g.aR,{children:[(0,a.jsx)(g.ZB,{children:"Feedback Form"}),(0,a.jsx)(g.BT,{children:"Select which form visitors will see when they scan your QR code for this property."})]}),(0,a.jsx)(g.Wu,{children:(0,a.jsx)("div",{className:"max-w-md",children:(0,a.jsx)(O,{forms:V,selectedFormId:F.feedbackFormId,onFormSelect:e=>eS(F.id,e),triggerClassName:"w-full"})})})]}),(0,a.jsxs)(g.Zp,{children:[(0,a.jsxs)(g.aR,{children:[(0,a.jsx)(g.ZB,{children:"Gifts"}),(0,a.jsx)(g.BT,{children:"Reward visitors for their feedback. When enabled, gifts are queued in your log for you to approve."})]}),(0,a.jsx)(g.Wu,{className:"space-y-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{children:(0,a.jsx)(el.J,{htmlFor:"enable-gifts-switch",className:"font-semibold text-base",children:"Enable Gifts"})}),(0,a.jsx)(en,{id:"enable-gifts-switch",checked:eq,onCheckedChange:eB})]})}),eq&&(0,a.jsx)(g.wL,{children:(0,a.jsxs)(b.$,{variant:"secondary",className:"w-full",onClick:()=>ev(!0),children:[(0,a.jsx)(M.A,{className:"mr-2"}),"Edit Gift Settings"]})})]})]}),(0,a.jsx)(Z.w,{}),(0,a.jsxs)(g.Zp,{className:"border-destructive",children:[(0,a.jsxs)(g.aR,{children:[(0,a.jsx)(g.ZB,{className:"text-destructive",children:"Danger Zone"}),(0,a.jsx)(g.BT,{children:"This is a permanent action and cannot be undone."})]}),(0,a.jsx)(g.Wu,{children:(0,a.jsxs)(B.Lt,{children:[(0,a.jsx)(B.tv,{asChild:!0,children:(0,a.jsxs)(b.$,{variant:"destructive",children:[(0,a.jsx)(R.A,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Delete Open House"})]})}),(0,a.jsxs)(B.EO,{children:[(0,a.jsxs)(B.wd,{children:[(0,a.jsx)(B.r7,{children:"Are you absolutely sure?"}),(0,a.jsx)(B.$v,{children:"This action cannot be undone. This will permanently delete your open house listing and all associated lead logs."})]}),(0,a.jsxs)(B.ck,{children:[(0,a.jsx)(B.Zr,{disabled:X,children:"Cancel"}),(0,a.jsx)(B.Rx,{onClick:eI,disabled:X,className:"bg-destructive hover:bg-destructive/90",children:X?"Deleting...":"Yes, delete it"})]})]})]})})]})]})}),(0,a.jsx)(H.lG,{open:eb,onOpenChange:ev,children:(0,a.jsxs)(H.Cf,{children:[(0,a.jsxs)(H.c7,{children:[(0,a.jsx)(H.L3,{children:"Gift Automation Settings"}),(0,a.jsx)(H.rr,{children:"Configure the gift that will be sent to visitors who provide feedback."})]}),(0,a.jsx)(ei.lV,{...eN,children:(0,a.jsxs)("form",{onSubmit:eN.handleSubmit(ez),className:"space-y-4 py-2",children:[(0,a.jsx)(ei.zB,{control:eN.control,name:"brandCode",render:e=>{let{field:t}=e;return(0,a.jsxs)(ei.eI,{children:[(0,a.jsx)(ei.lR,{children:"Brand"}),(0,a.jsxs)(q.l6,{onValueChange:t.onChange,defaultValue:t.value,children:[(0,a.jsx)(ei.MJ,{children:(0,a.jsx)(q.bq,{children:(0,a.jsx)(q.yv,{placeholder:"Select brand"})})}),(0,a.jsx)(q.gC,{children:G.map(e=>(0,a.jsx)(q.eb,{value:e.brand_code,className:"capitalize",children:e.name},e.brand_code))})]}),(0,a.jsx)(ei.C5,{})]})}}),(0,a.jsxs)("div",{className:"flex gap-4 items-end",children:[(0,a.jsx)(ei.zB,{control:eN.control,name:"amountSelection",render:e=>{let{field:t}=e;return(0,a.jsxs)(ei.eI,{className:"flex-1",children:[(0,a.jsx)(ei.lR,{children:"Amount"}),(0,a.jsxs)(q.l6,{onValueChange:t.onChange,defaultValue:t.value,disabled:!eC,children:[(0,a.jsx)(ei.MJ,{children:(0,a.jsx)(q.bq,{children:(0,a.jsx)(q.yv,{placeholder:"Select amount"})})}),(0,a.jsxs)(q.gC,{children:[(0,a.jsx)(q.eb,{value:"500",children:"$5.00"}),(0,a.jsx)(q.eb,{value:"1000",children:"$10.00"}),(0,a.jsx)(q.eb,{value:"1500",children:"$15.00"}),(0,a.jsx)(q.eb,{value:"custom",children:"Custom"})]})]}),(0,a.jsx)(ei.C5,{})]})}}),"custom"===ek&&(0,a.jsx)(ei.zB,{control:eN.control,name:"customAmount",render:e=>{let{field:t}=e;return(0,a.jsxs)(ei.eI,{className:"w-28",children:[(0,a.jsx)(ei.MJ,{children:(0,a.jsx)(eo.p,{type:"number",placeholder:"USD",step:"1",...t,onChange:e=>{let s=e.target.value;t.onChange(""===s?void 0:parseFloat(s))}})}),(0,a.jsx)(ei.C5,{})]})}})]}),(0,a.jsx)(ei.zB,{control:eN.control,name:"autoSend",render:e=>{let{field:t}=e;return(0,a.jsxs)(ei.eI,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm mt-4",children:[(0,a.jsxs)("div",{className:"space-y-0.5",children:[(0,a.jsxs)(ei.lR,{className:"flex items-center gap-2",children:[(0,a.jsx)(z.A,{className:"h-5 w-5 text-yellow-500"}),"Auto-Send Gifts"]}),(0,a.jsx)(ei.Rr,{children:"Automatically send gifts and spend money from your balance."})]}),(0,a.jsx)(ei.MJ,{children:(0,a.jsx)(en,{checked:t.value,onCheckedChange:t.onChange})})]})}}),(0,a.jsxs)(H.Es,{className:"pt-4",children:[(0,a.jsx)(b.$,{type:"button",variant:"ghost",onClick:()=>ev(!1),children:"Cancel"}),(0,a.jsx)(b.$,{type:"submit",disabled:eN.formState.isSubmitting,children:eN.formState.isSubmitting?"Saving...":"Save Settings"})]})]})})]})}),(0,a.jsx)(H.lG,{open:em,onOpenChange:eh,children:(0,a.jsxs)(H.Cf,{children:[(0,a.jsxs)(H.c7,{children:[(0,a.jsx)(H.L3,{children:"Edit Address"}),(0,a.jsx)(H.rr,{children:"Update the address details for this open house."})]}),(0,a.jsx)(ei.lV,{...ew,children:(0,a.jsxs)("form",{onSubmit:ew.handleSubmit(eE),className:"space-y-4 py-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-4 gap-4",children:[(0,a.jsx)("div",{className:"col-span-1",children:(0,a.jsx)(ei.zB,{control:ew.control,name:"streetNumber",render:e=>{let{field:t}=e;return(0,a.jsxs)(ei.eI,{children:[(0,a.jsx)(ei.lR,{children:"Number"}),(0,a.jsx)(ei.MJ,{children:(0,a.jsx)(eo.p,{...t})}),(0,a.jsx)(ei.C5,{})]})}})}),(0,a.jsx)("div",{className:"col-span-3",children:(0,a.jsx)(ei.zB,{control:ew.control,name:"streetName",render:e=>{let{field:t}=e;return(0,a.jsxs)(ei.eI,{children:[(0,a.jsx)(ei.lR,{children:"Street Name"}),(0,a.jsx)(ei.MJ,{children:(0,a.jsx)(eo.p,{...t})}),(0,a.jsx)(ei.C5,{})]})}})})]}),(0,a.jsx)(ei.zB,{control:ew.control,name:"unitNumber",render:e=>{let{field:t}=e;return(0,a.jsxs)(ei.eI,{children:[(0,a.jsx)(ei.lR,{children:"Unit Number (Optional)"}),(0,a.jsx)(ei.MJ,{children:(0,a.jsx)(eo.p,{...t})}),(0,a.jsx)(ei.C5,{})]})}}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,a.jsx)("div",{className:"col-span-2",children:(0,a.jsx)(ei.zB,{control:ew.control,name:"city",render:e=>{let{field:t}=e;return(0,a.jsxs)(ei.eI,{children:[(0,a.jsx)(ei.lR,{children:"City"}),(0,a.jsx)(ei.MJ,{children:(0,a.jsx)(eo.p,{...t})}),(0,a.jsx)(ei.C5,{})]})}})}),(0,a.jsx)(ei.zB,{control:ew.control,name:"state",render:e=>{let{field:t}=e;return(0,a.jsxs)(ei.eI,{children:[(0,a.jsx)(ei.lR,{children:"State"}),(0,a.jsx)(ei.MJ,{children:(0,a.jsx)(eo.p,{...t})}),(0,a.jsx)(ei.C5,{})]})}})]}),(0,a.jsx)(ei.zB,{control:ew.control,name:"zipCode",render:e=>{let{field:t}=e;return(0,a.jsxs)(ei.eI,{children:[(0,a.jsx)(ei.lR,{children:"Zip Code"}),(0,a.jsx)(ei.MJ,{children:(0,a.jsx)(eo.p,{...t})}),(0,a.jsx)(ei.C5,{})]})}}),(0,a.jsxs)(H.Es,{className:"pt-4",children:[(0,a.jsx)(b.$,{type:"button",variant:"ghost",onClick:()=>eh(!1),children:"Cancel"}),(0,a.jsx)(b.$,{type:"submit",disabled:ew.formState.isSubmitting,children:ew.formState.isSubmitting?"Saving...":"Save Address"})]})]})})]})}),(0,a.jsx)(B.Lt,{open:ej,onOpenChange:eg,children:(0,a.jsxs)(B.EO,{children:[(0,a.jsxs)(B.wd,{children:[(0,a.jsx)(B.r7,{children:"Are you sure?"}),(0,a.jsx)(B.$v,{children:"This will permanently remove the image for this open house. This action cannot be undone."})]}),(0,a.jsxs)(B.ck,{children:[(0,a.jsx)(B.Zr,{children:"Cancel"}),(0,a.jsx)(B.Rx,{onClick:eM,className:"bg-destructive hover:bg-destructive/90",children:"Yes, remove image"})]})]})})]})}},8030:(e,t,s)=>{"use strict";s.d(t,{A:()=>u,AuthProvider:()=>c});var a=s(5155),r=s(2115),n=s(3004),l=s(5317),i=s(8214),o=s(5695);let d=(0,r.createContext)(void 0);function c(e){let{children:t}=e,[s,c]=(0,r.useState)(null),[u,m]=(0,r.useState)(!0),[h,x]=(0,r.useState)(0),[f,p]=(0,r.useState)(0),j=(0,o.useRouter)(),g=(0,r.useCallback)(async e=>{if(!e)return null;let t=(0,l.H9)(i.db,"users",e.uid);try{let s=await (0,l.x7)(t),a=(0,l.query)((0,l.collection)(i.db,"gifts"),(0,l.where)("userId","==",e.uid),(0,l.where)("status","==","queued")),r=await (0,l.getDocs)(a);if(x(r.size),s.exists()){let t=s.data();return p(t.availableBalance||0),{...e,...t}}{console.log("User profile for ".concat(e.uid," not found, creating one."));let s={id:e.uid,email:e.email||"",name:e.displayName||"New User",phone:"",availableBalance:1e4};return await (0,l.BN)(t,s,{merge:!0}),p(s.availableBalance),{...e,...s}}}catch(t){return console.error("Error fetching user profile:",t),e}},[]);(0,r.useEffect)(()=>{let e=(0,n.hg)(i.j2,async e=>{e?c(await g(e)):(c(null),x(0),p(0)),m(!1)});return()=>e()},[g]);let b={user:s,loading:u,pendingGiftsCount:h,availableBalance:f,refreshUserData:(0,r.useCallback)(async()=>{let e=i.j2.currentUser;e&&(m(!0),c(await g(e)),m(!1))},[g]),signIn:(e,t,s)=>(0,n.x9)(e,t,s),signUp:(e,t,s)=>(0,n.eJ)(e,t,s),signOut:async()=>{await (0,n.CI)(i.j2),j.push("/")},sendPasswordResetEmail:n.J1};return(0,a.jsx)(d.Provider,{value:b,children:t})}function u(){let e=(0,r.useContext)(d);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},8186:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(157).A)("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]])},8763:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(157).A)("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]])},9401:(e,t,s)=>{Promise.resolve().then(s.bind(s,7887))},9737:(e,t,s)=>{"use strict";let a;s.d(t,{A:()=>i});let r={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)},n=new Uint8Array(16),l=[];for(let e=0;e<256;++e)l.push((e+256).toString(16).slice(1));let i=function(e,t,s){if(r.randomUUID&&!t&&!e)return r.randomUUID();let i=(e=e||{}).random||(e.rng||function(){if(!a&&!(a="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return a(n)})();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t){s=s||0;for(let e=0;e<16;++e)t[s+e]=i[e];return t}return function(e,t=0){return l[e[t+0]]+l[e[t+1]]+l[e[t+2]]+l[e[t+3]]+"-"+l[e[t+4]]+l[e[t+5]]+"-"+l[e[t+6]]+l[e[t+7]]+"-"+l[e[t+8]]+l[e[t+9]]+"-"+l[e[t+10]]+l[e[t+11]]+l[e[t+12]]+l[e[t+13]]+l[e[t+14]]+l[e[t+15]]}(i)}},9829:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(157).A)("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]])}},e=>{var t=t=>e(e.s=t);e.O(0,[992,644,686,488,874,661,63,512,411,591,321,441,684,358],()=>t(9401)),_N_E=e.O()}]);