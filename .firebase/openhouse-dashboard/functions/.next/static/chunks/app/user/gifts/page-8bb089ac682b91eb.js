(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[996],{295:(e,t,s)=>{"use strict";s.d(t,{f:()=>r});var a=s(4477);let r=(0,a.createServerReference)("002a7ac215804b5b9787d8ab7a455cdcccc8da7d92",a.callServer,void 0,a.findSourceMapURL,"listBrands")},1638:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>_});var a=s(5155),r=s(2115),n=s(5317),l=s(8214),i=s(8030),d=s(6874),o=s.n(d),c=s(8184),u=s(2177),m=s(221),h=s(4477);let x=(0,h.createServerReference)("4043086ea46a06c7f3e1e7eb528e3b4372bba028a4",h.callServer,void 0,h.findSourceMapURL,"sendGift");var p=s(5594);let f=p.z.object({recipientName:p.z.string().min(1,"Recipient name is required."),recipientEmail:p.z.string().email("Please enter a valid email address."),brandCode:p.z.string().min(1,"Please select a brand."),amountSelection:p.z.string(),customAmount:p.z.number().optional(),message:p.z.string().optional(),selectedBrand:p.z.custom().optional()}).refine(e=>{if(!e.selectedBrand||"custom"!==e.amountSelection)return!0;if(void 0===e.customAmount||null===e.customAmount||e.customAmount<=0||!e.selectedBrand.denominations||0===e.selectedBrand.denominations.length)return!1;let t=100*e.customAmount,s=e.selectedBrand.denominations[0].min,a=e.selectedBrand.denominations[0].max;return t>=s&&t<=a},{message:"Custom amount is not within the allowed range for this brand.",path:["customAmount"]}).refine(e=>"custom"!==e.amountSelection||void 0!==e.customAmount&&e.customAmount>0,{message:"A custom amount is required.",path:["customAmount"]});p.z.object({userId:p.z.string(),recipientName:p.z.string(),recipientEmail:p.z.string().email(),brandCode:p.z.string(),amountInCents:p.z.number().int().positive(),message:p.z.string().optional(),openHouseAddress:p.z.string().optional(),giftIdToUpdate:p.z.string().optional()});var g=s(9434),j=s(295),b=s(6695),v=s(5127),y=s(6126),N=s(7481),w=s(518),A=s(7554),k=s(157);let C=(0,k.A)("Hourglass",[["path",{d:"M5 22h14",key:"ehvnwv"}],["path",{d:"M5 2h14",key:"pdyrp9"}],["path",{d:"M17 22v-4.172a2 2 0 0 0-.586-1.414L12 12l-4.414 4.414A2 2 0 0 0 7 17.828V22",key:"1d314k"}],["path",{d:"M7 2v4.172a2 2 0 0 0 .586 1.414L12 12l4.414-4.414A2 2 0 0 0 17 6.172V2",key:"1vvvr6"}]]);var M=s(5318);let S=(0,k.A)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);var z=s(2160);let E=(0,k.A)("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);var R=s(1840);let I=(0,k.A)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),q=(0,k.A)("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]),B=(0,k.A)("Wallet",[["path",{d:"M19 7V4a1 1 0 0 0-1-1H5a2 2 0 0 0 0 4h15a1 1 0 0 1 1 1v4h-3a2 2 0 0 0 0 4h3a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1",key:"18etb6"}],["path",{d:"M3 5v14a2 2 0 0 0 2 2h15a1 1 0 0 0 1-1v-4",key:"xoc0q4"}]]);var H=s(285),L=s(4165),G=s(7759),T=s(2523),P=s(8539),$=s(9409),U=s(10);function _(){let{user:e,refreshUserData:t,loading:s}=(0,i.A)(),{toast:d}=(0,N.dj)(),[h,p]=(0,r.useState)([]),[k,_]=(0,r.useState)(!0),[D,O]=(0,r.useState)(!1),[V,F]=(0,r.useState)([]),[J,Y]=(0,r.useState)(!1),[Z,Q]=(0,r.useState)(null),[X,W]=(0,r.useState)(null),[K,ee]=(0,r.useState)(!1),et=(0,r.useCallback)(async()=>{if(e){_(!0);try{let t=(0,n.query)((0,n.collection)(l.db,"gifts"),(0,n.where)("userId","==",e.uid),(0,n.My)("createdAt","desc")),s=(await (0,n.getDocs)(t)).docs.map(e=>({id:e.id,...e.data()}));s.sort((e,t)=>"queued"===e.status&&"queued"!==t.status?-1:+("queued"!==e.status&&"queued"===t.status)),p(s);let a=await (0,j.f)();F(a)}catch(e){console.error("Error fetching gifts or settings:",e)}_(!1)}},[e]);(0,r.useEffect)(()=>{!s&&e&&et()},[s,e,et]);let es=(0,u.mN)({resolver:(0,m.u)(f),defaultValues:{recipientName:"",recipientEmail:"",brandCode:"",amountSelection:"500",customAmount:0,message:""}}),ea=es.watch("amountSelection"),er=es.watch("brandCode"),en=(0,r.useMemo)(()=>V.find(e=>e.brand_code===er),[V,er]);async function el(s){if(!e)return;let a=0;a="custom"===s.amountSelection?s.customAmount?100*s.customAmount:0:parseInt(s.amountSelection,10);let r={userId:e.uid,recipientName:s.recipientName,recipientEmail:s.recipientEmail,brandCode:s.brandCode,amountInCents:a,message:s.message},n={...s,selectedBrand:en},l=f.safeParse(n);if(!l.success)return void l.error.errors.forEach(e=>{let t=e.path[0];es.setError(t,{type:"manual",message:e.message})});try{let e=await x(r);if(e.success)d({title:"Gift Queued!",description:"Your gift is being processed and will be sent shortly."}),es.reset(),O(!1),await Promise.all([et(),t()]);else throw Error(e.message)}catch(e){console.error("Error sending manual gift:",e),d({variant:"destructive",title:"Error Sending Gift",description:e.message||"Could not send the gift. Please check server logs."})}}let ei=async()=>{if(e&&Z&&X){Y(!0);try{if("approve"===X){if((e.availableBalance||0)<Z.amountInCents)return void ee(!0);let t=(0,n.H9)(l.db,"gifts",Z.id);await (0,n.mZ)(t,{status:"processing"}),d({title:"Gift Approved",description:"The gift is now being processed."})}else if("deny"===X){let e=(0,n.H9)(l.db,"gifts",Z.id);await (0,n.mZ)(e,{status:"denied"}),d({title:"Gift Denied",description:"The gift has been denied and will not be sent."})}await Promise.all([et(),t()])}catch(e){var s;console.error("Error confirming gift:",e),(null==(s=e.message)?void 0:s.includes("Insufficient funds"))?ee(!0):d({variant:"destructive",title:"Action Failed",description:e.message||"Could not complete the action."})}finally{Y(!1),Q(null),W(null)}}},ed=(e,t)=>{Q(e),W(t)},eo=e=>{switch(e){case"sent":return(0,a.jsxs)(y.E,{className:"bg-green-600 hover:bg-green-700",children:[(0,a.jsx)(w.A,{className:"mr-1.5"}),"Sent"]});case"processing":return(0,a.jsxs)(y.E,{variant:"secondary",className:"bg-blue-500/20 text-blue-700 border border-blue-500/30 hover:bg-blue-500/30",children:[(0,a.jsx)(A.A,{className:"mr-1.5 animate-spin"}),"Processing"]});case"queued":return(0,a.jsxs)(y.E,{variant:"secondary",className:"bg-yellow-500/20 text-yellow-700 border border-yellow-500/30 hover:bg-yellow-500/30",children:[(0,a.jsx)(C,{className:"mr-1.5"}),"Queued"]});case"denied":return(0,a.jsxs)(y.E,{variant:"destructive",children:[(0,a.jsx)(M.A,{className:"mr-1.5"}),"Denied"]});case"error":return(0,a.jsxs)(y.E,{variant:"destructive",className:"bg-red-500/20 text-red-700 border-red-500/30 hover:bg-red-500/30",children:[(0,a.jsx)(S,{className:"mr-1.5"}),"Error"]});default:return(0,a.jsx)(y.E,{variant:"outline",children:e})}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"w-full mx-auto space-y-8",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold tracking-tight font-headline",children:"Gift Log"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"A history of all gifts you've sent, including those pending approval."})]}),(0,a.jsxs)(L.lG,{open:D,onOpenChange:O,children:[(0,a.jsx)(L.zM,{asChild:!0,children:(0,a.jsxs)(H.$,{children:[(0,a.jsx)(z.A,{className:"mr-2 h-4 w-4"}),"Send a Gift"]})}),(0,a.jsxs)(L.Cf,{className:"sm:max-w-[425px]",children:[(0,a.jsxs)(L.c7,{children:[(0,a.jsx)(L.L3,{children:"Send a Manual Gift"}),(0,a.jsx)(L.rr,{children:"Fill out the details below to send a gift card. This will be sent immediately."})]}),(0,a.jsx)(G.lV,{...es,children:(0,a.jsxs)("form",{onSubmit:es.handleSubmit(el),className:"space-y-4",children:[(0,a.jsx)(G.zB,{control:es.control,name:"recipientName",render:e=>{let{field:t}=e;return(0,a.jsxs)(G.eI,{children:[(0,a.jsx)(G.lR,{children:"Recipient Name"}),(0,a.jsx)(G.MJ,{children:(0,a.jsx)(T.p,{placeholder:"John Doe",...t})}),(0,a.jsx)(G.C5,{})]})}}),(0,a.jsx)(G.zB,{control:es.control,name:"recipientEmail",render:e=>{let{field:t}=e;return(0,a.jsxs)(G.eI,{children:[(0,a.jsx)(G.lR,{children:"Recipient Email"}),(0,a.jsx)(G.MJ,{children:(0,a.jsx)(T.p,{placeholder:"name@example.com",...t})}),(0,a.jsx)(G.C5,{})]})}}),(0,a.jsx)(G.zB,{control:es.control,name:"brandCode",render:e=>{let{field:t}=e;return(0,a.jsxs)(G.eI,{children:[(0,a.jsx)(G.lR,{children:"Brand"}),(0,a.jsxs)($.l6,{onValueChange:t.onChange,defaultValue:t.value,children:[(0,a.jsx)(G.MJ,{children:(0,a.jsx)($.bq,{children:(0,a.jsx)($.yv,{placeholder:"Select brand"})})}),(0,a.jsx)($.gC,{children:V.length>0?V.map(e=>(0,a.jsx)($.eb,{value:e.brand_code,className:"capitalize",children:e.name},e.brand_code)):(0,a.jsx)("p",{className:"p-4 text-sm text-muted-foreground",children:"No brands available. Check server configuration."})})]}),(0,a.jsx)(G.C5,{})]})}}),(0,a.jsxs)("div",{className:"flex gap-4 items-end",children:[(0,a.jsx)(G.zB,{control:es.control,name:"amountSelection",render:e=>{let{field:t}=e;return(0,a.jsxs)(G.eI,{className:"flex-1",children:[(0,a.jsx)(G.lR,{children:"Amount"}),(0,a.jsxs)($.l6,{onValueChange:t.onChange,value:t.value,disabled:!er,children:[(0,a.jsx)(G.MJ,{children:(0,a.jsx)($.bq,{children:(0,a.jsx)($.yv,{placeholder:"Amount"})})}),(0,a.jsxs)($.gC,{children:[(0,a.jsx)($.eb,{value:"500",children:"$5.00"}),(0,a.jsx)($.eb,{value:"1000",children:"$10.00"}),(0,a.jsx)($.eb,{value:"1500",children:"$15.00"}),(0,a.jsx)($.eb,{value:"custom",children:"Custom"})]})]}),(0,a.jsx)(G.C5,{})]})}}),"custom"===ea&&(0,a.jsx)(G.zB,{control:es.control,name:"customAmount",render:e=>{let{field:t}=e;return(0,a.jsxs)(G.eI,{className:"w-28",children:[(0,a.jsx)(G.MJ,{children:(0,a.jsx)(T.p,{type:"number",placeholder:"Custom",step:"1",...t,onChange:e=>{let s=e.target.value;t.onChange(""===s?void 0:parseFloat(s))}})}),(0,a.jsx)(G.C5,{})]})}})]}),(0,a.jsx)(G.zB,{control:es.control,name:"message",render:e=>{let{field:t}=e;return(0,a.jsxs)(G.eI,{children:[(0,a.jsx)(G.lR,{children:"Message (Optional)"}),(0,a.jsx)(G.MJ,{children:(0,a.jsx)(P.T,{placeholder:"Enjoy a coffee on me!",...t})}),(0,a.jsx)(G.C5,{})]})}}),(0,a.jsxs)(L.Es,{children:[(0,a.jsx)(H.$,{type:"button",variant:"ghost",onClick:()=>O(!1),children:"Cancel"}),(0,a.jsx)(H.$,{type:"submit",disabled:es.formState.isSubmitting,children:es.formState.isSubmitting?"Sending...":"Send Gift"})]})]})})]})]})]}),(0,a.jsxs)(b.Zp,{children:[(0,a.jsxs)(b.aR,{children:[(0,a.jsx)(b.ZB,{children:"Gift Log"}),(0,a.jsx)(b.BT,{children:"This log tracks both automated and manually sent gifts. Gifts with a 'Queued' status require your approval."})]}),(0,a.jsx)(b.Wu,{children:k?(0,a.jsx)("p",{children:"Loading gift history..."}):h.length>0?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"border rounded-lg overflow-x-auto hidden md:block",children:(0,a.jsxs)(v.XI,{children:[(0,a.jsx)(v.A0,{children:(0,a.jsxs)(v.Hj,{children:[(0,a.jsx)(v.nd,{children:"Recipient"}),(0,a.jsx)(v.nd,{children:"Gift"}),(0,a.jsx)(v.nd,{children:"Type"}),(0,a.jsx)(v.nd,{children:"Date"}),(0,a.jsx)(v.nd,{className:"text-right",children:"Status / Action"})]})}),(0,a.jsx)(v.BF,{children:h.map(e=>(0,a.jsxs)(v.Hj,{className:(0,g.cn)("queued"===e.status&&"bg-yellow-50 dark:bg-yellow-950/20","error"===e.status&&"bg-red-50 dark:bg-red-950/20"),children:[(0,a.jsxs)(v.nA,{children:[(0,a.jsx)("div",{className:"font-medium",children:e.recipientName}),(0,a.jsx)("div",{className:"text-sm text-muted-foreground",children:e.recipientEmail})]}),(0,a.jsx)(v.nA,{children:(0,a.jsxs)(y.E,{variant:"secondary",className:"capitalize",children:["$",(e.amountInCents/100).toFixed(2)," ",e.brandCode]})}),(0,a.jsx)(v.nA,{children:"automated"===e.type&&e.openHouseId?(0,a.jsxs)(o(),{href:"/user/open-house/".concat(e.openHouseId),title:"Sent from: ".concat(e.openHouseAddress),className:"hover:underline flex items-center gap-2",children:[(0,a.jsx)("span",{children:"Open House"}),(0,a.jsx)(E,{className:"h-4 w-4"})]}):(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{children:"Manual"}),(0,a.jsx)(z.A,{className:"h-4 w-4"})]})}),(0,a.jsx)(v.nA,{children:(0,c.GP)(e.createdAt.toDate(),"MMM d, yyyy, p")}),(0,a.jsx)(v.nA,{className:"text-right",children:"queued"===e.status?(0,a.jsxs)("div",{className:"flex gap-2 justify-end",children:[(0,a.jsxs)(H.$,{size:"sm",variant:"outline",className:"bg-red-500/10 text-red-600 border-red-500/30 hover:bg-red-500/20",onClick:()=>ed(e,"deny"),children:[(0,a.jsx)(M.A,{className:"mr-1.5"})," Deny"]}),(0,a.jsxs)(H.$,{size:"sm",variant:"outline",className:"bg-green-500/10 text-green-600 border-green-500/30 hover:bg-green-500/20",onClick:()=>ed(e,"approve"),children:[(0,a.jsx)(w.A,{className:"mr-1.5"})," Approve"]})]}):"sent"===e.status&&e.claimUrl?(0,a.jsx)(H.$,{asChild:!0,variant:"outline",size:"sm",children:(0,a.jsxs)("a",{href:e.claimUrl,target:"_blank",rel:"noopener noreferrer",children:["View Claim Link ",(0,a.jsx)(R.A,{className:"ml-2 h-3 w-3"})]})}):eo(e.status)})]},e.id))})]})}),(0,a.jsx)("div",{className:"space-y-4 md:hidden",children:h.map(e=>(0,a.jsxs)(b.Zp,{className:(0,g.cn)("p-4","queued"===e.status&&"bg-yellow-50 dark:bg-yellow-950/20","error"===e.status&&"bg-red-50 dark:bg-red-950/20"),children:[(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold",children:e.recipientName}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:e.recipientEmail})]}),eo(e.status)]}),(0,a.jsxs)("div",{className:"mt-4 pt-4 border-t text-sm text-muted-foreground space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(z.A,{className:"h-4 w-4"}),(0,a.jsxs)("span",{className:"capitalize font-medium text-foreground",children:["$",(e.amountInCents/100).toFixed(2)," ",e.brandCode]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(I,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:(0,c.GP)(e.createdAt.toDate(),"MMM d, yyyy, p")})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(q,{className:"h-4 w-4"}),"automated"===e.type&&e.openHouseId?(0,a.jsxs)(o(),{href:"/user/open-house/".concat(e.openHouseId),title:"Sent from: ".concat(e.openHouseAddress),className:"text-primary hover:underline flex items-center gap-2",children:[(0,a.jsx)("span",{children:"Open House Gift"}),(0,a.jsx)(E,{className:"h-4 w-4"})]}):(0,a.jsx)("span",{children:"Manual Gift"})]}),"error"===e.status&&e.errorMessage&&(0,a.jsx)("p",{className:"text-destructive text-xs",children:e.errorMessage})]}),"queued"===e.status?(0,a.jsx)(b.wL,{className:"p-0 pt-4 mt-4 border-t",children:(0,a.jsxs)("div",{className:"flex gap-2 w-full",children:[(0,a.jsxs)(H.$,{size:"sm",variant:"outline",className:"w-full bg-red-500/10 text-red-600 border-red-500/30 hover:bg-red-500/20",onClick:()=>ed(e,"deny"),children:[(0,a.jsx)(M.A,{className:"mr-1.5"})," Deny"]}),(0,a.jsxs)(H.$,{size:"sm",className:"w-full bg-green-600 hover:bg-green-700",onClick:()=>ed(e,"approve"),children:[(0,a.jsx)(w.A,{className:"mr-1.5"})," Approve & Send"]})]})}):"sent"===e.status&&e.claimUrl?(0,a.jsx)(b.wL,{className:"p-0 pt-4 mt-4 border-t",children:(0,a.jsx)(H.$,{asChild:!0,variant:"outline",size:"sm",className:"w-full",children:(0,a.jsxs)("a",{href:e.claimUrl,target:"_blank",rel:"noopener noreferrer",children:["View Claim Link ",(0,a.jsx)(R.A,{className:"ml-2 h-3 w-3"})]})})}):null]},e.id))})]}):(0,a.jsxs)("div",{className:"text-center py-16 border-2 border-dashed rounded-lg",children:[(0,a.jsx)(B,{className:"mx-auto h-12 w-12 text-muted-foreground"}),(0,a.jsx)("h3",{className:"text-xl font-medium mt-4",children:"No Gifts Sent Yet"}),(0,a.jsx)("p",{className:"text-muted-foreground mt-2",children:"Your gift sending history will appear here."})]})})]})]}),(0,a.jsx)(U.Lt,{open:!!Z,onOpenChange:e=>!e&&Q(null),children:(0,a.jsxs)(U.EO,{children:[(0,a.jsxs)(U.wd,{children:[(0,a.jsx)(U.r7,{children:"Confirm Action"}),(0,a.jsx)(U.$v,{children:"approve"===X?"Are you sure you want to approve and send a $".concat((((null==Z?void 0:Z.amountInCents)||0)/100).toFixed(2)," ").concat(null==Z?void 0:Z.brandCode," gift to ").concat(null==Z?void 0:Z.recipientName,"?"):"Are you sure you want to deny this gift for ".concat(null==Z?void 0:Z.recipientName,"? This cannot be undone.")})]}),(0,a.jsxs)(U.ck,{children:[(0,a.jsx)(U.Zr,{disabled:J,onClick:()=>Q(null),children:"Cancel"}),(0,a.jsx)(U.Rx,{disabled:J,onClick:ei,className:"deny"===X?"bg-destructive hover:bg-destructive/90":"",children:J?"Processing...":"approve"===X?"Yes, Approve & Send":"Yes, Deny Gift"})]})]})}),(0,a.jsx)(U.Lt,{open:K,onOpenChange:ee,children:(0,a.jsxs)(U.EO,{children:[(0,a.jsxs)(U.wd,{children:[(0,a.jsx)(U.r7,{children:"Insufficient Balance"}),(0,a.jsx)(U.$v,{children:"You do not have enough funds to send this gift. Please top up your account balance on the billing page."})]}),(0,a.jsxs)(U.ck,{children:[(0,a.jsx)(U.Zr,{onClick:()=>ee(!1),children:"OK"}),(0,a.jsx)(U.Rx,{asChild:!0,children:(0,a.jsx)(o(),{href:"/user/billing",children:"Go to Billing"})})]})]})})]})}},1840:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(157).A)("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]])},2160:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(157).A)("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]])},4165:(e,t,s)=>{"use strict";s.d(t,{Cf:()=>m,Es:()=>x,L3:()=>p,c7:()=>h,lG:()=>d,rr:()=>f,zM:()=>o});var a=s(5155),r=s(2115),n=s(5821),l=s(5318),i=s(9434);let d=n.bL,o=n.l9,c=n.ZL;n.bm;let u=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.hJ,{ref:t,className:(0,i.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...r})});u.displayName=n.hJ.displayName;let m=r.forwardRef((e,t)=>{let{className:s,children:r,...d}=e;return(0,a.jsxs)(c,{children:[(0,a.jsx)(u,{}),(0,a.jsxs)(n.UC,{ref:t,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...d,children:[r,(0,a.jsxs)(n.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(l.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});m.displayName=n.UC.displayName;let h=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...s})};h.displayName="DialogHeader";let x=e=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...s})};x.displayName="DialogFooter";let p=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.hE,{ref:t,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",s),...r})});p.displayName=n.hE.displayName;let f=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(n.VY,{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",s),...r})});f.displayName=n.VY.displayName},4477:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var s in t)Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}(t,{callServer:function(){return a.callServer},createServerReference:function(){return n},findSourceMapURL:function(){return r.findSourceMapURL}});let a=s(3806),r=s(1818),n=s(4979).createServerReference},5127:(e,t,s)=>{"use strict";s.d(t,{A0:()=>i,BF:()=>d,Hj:()=>o,XI:()=>l,nA:()=>u,nd:()=>c});var a=s(5155),r=s(2115),n=s(9434);let l=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:t,className:(0,n.cn)("w-full caption-bottom text-sm",s),...r})})});l.displayName="Table";let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("thead",{ref:t,className:(0,n.cn)("[&_tr]:border-b",s),...r})});i.displayName="TableHeader";let d=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("tbody",{ref:t,className:(0,n.cn)("[&_tr:last-child]:border-0",s),...r})});d.displayName="TableBody",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("tfoot",{ref:t,className:(0,n.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...r})}).displayName="TableFooter";let o=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("tr",{ref:t,className:(0,n.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",s),...r})});o.displayName="TableRow";let c=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("th",{ref:t,className:(0,n.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s),...r})});c.displayName="TableHead";let u=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("td",{ref:t,className:(0,n.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...r})});u.displayName="TableCell",r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("caption",{ref:t,className:(0,n.cn)("mt-4 text-sm text-muted-foreground",s),...r})}).displayName="TableCaption"},5318:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(157).A)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},6126:(e,t,s)=>{"use strict";s.d(t,{E:()=>i});var a=s(5155);s(2115);var r=s(2085),n=s(9434);let l=(0,r.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:t,variant:s,...r}=e;return(0,a.jsx)("div",{className:(0,n.cn)(l({variant:s}),t),...r})}},7554:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(157).A)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},8030:(e,t,s)=>{"use strict";s.d(t,{A:()=>u,AuthProvider:()=>c});var a=s(5155),r=s(2115),n=s(3004),l=s(5317),i=s(8214),d=s(5695);let o=(0,r.createContext)(void 0);function c(e){let{children:t}=e,[s,c]=(0,r.useState)(null),[u,m]=(0,r.useState)(!0),[h,x]=(0,r.useState)(0),[p,f]=(0,r.useState)(0),g=(0,d.useRouter)(),j=(0,r.useCallback)(async e=>{if(!e)return null;let t=(0,l.H9)(i.db,"users",e.uid);try{let s=await (0,l.x7)(t),a=(0,l.query)((0,l.collection)(i.db,"gifts"),(0,l.where)("userId","==",e.uid),(0,l.where)("status","==","queued")),r=await (0,l.getDocs)(a);if(x(r.size),s.exists()){let t=s.data();return f(t.availableBalance||0),{...e,...t}}{console.log("User profile for ".concat(e.uid," not found, creating one."));let s={id:e.uid,email:e.email||"",name:e.displayName||"New User",phone:"",availableBalance:1e4};return await (0,l.BN)(t,s,{merge:!0}),f(s.availableBalance),{...e,...s}}}catch(t){return console.error("Error fetching user profile:",t),e}},[]);(0,r.useEffect)(()=>{let e=(0,n.hg)(i.j2,async e=>{e?c(await j(e)):(c(null),x(0),f(0)),m(!1)});return()=>e()},[j]);let b={user:s,loading:u,pendingGiftsCount:h,availableBalance:p,refreshUserData:(0,r.useCallback)(async()=>{let e=i.j2.currentUser;e&&(m(!0),c(await j(e)),m(!1))},[j]),signIn:(e,t,s)=>(0,n.x9)(e,t,s),signUp:(e,t,s)=>(0,n.eJ)(e,t,s),signOut:async()=>{await (0,n.CI)(i.j2),g.push("/")},sendPasswordResetEmail:n.J1};return(0,a.jsx)(o.Provider,{value:b,children:t})}function u(){let e=(0,r.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},8539:(e,t,s)=>{"use strict";s.d(t,{T:()=>l});var a=s(5155),r=s(2115),n=s(9434);let l=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("textarea",{className:(0,n.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...r})});l.displayName="Textarea"},9571:(e,t,s)=>{Promise.resolve().then(s.bind(s,1638))}},e=>{var t=t=>e(e.s=t);e.O(0,[992,644,686,488,874,661,512,411,206,321,441,684,358],()=>t(9571)),_N_E=e.O()}]);